<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Standoff 2 - –û–Ω–ª–∞–π–Ω —Ä—ã–Ω–æ–∫</title>
    
    <!-- PWA –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="theme-color" content="#1a237e">
    <meta name="description" content="Standoff 2 —Å –æ–Ω–ª–∞–π–Ω-—Ä—ã–Ω–∫–æ–º, –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–º, –∫–µ–π—Å–∞–º–∏ –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ —Å–∫–∏–Ω–∞–º–∏">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî´</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî´</text></svg>">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è... */
        :root {
            --primary: #1a237e;
            --primary-dark: #0d1440;
            --secondary: #ff9800;
            --secondary-dark: #e68900;
            --gold: #ffd700;
            --gold-dark: #cca300;
            --silver: #c0c0c0;
            --silver-dark: #8a8a8a;
            --success: #4caf50;
            --danger: #f44336;
            --epic: #9c27b0;
            --legendary: #ff9800;
            --rare: #2196f3;
            --uncommon: #4caf50;
            --common: #616161;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a2e 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            /* PWA –¥–æ–±–∞–≤–∫–∏ */
            -webkit-overflow-scrolling: touch;
            overscroll-behavior-y: none;
        }

        /* PWA —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–Ω–Ω–µ—Ä */
        .pwa-install-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 15px 20px;
            display: none;
            align-items: center;
            justify-content: space-between;
            z-index: 2000;
            border-top: 2px solid var(--secondary);
            box-shadow: 0 -5px 20px rgba(0,0,0,0.3);
        }

        .pwa-install-banner.show {
            display: flex;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .pwa-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 5px 10px;
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º–∏... */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .container {
            max-width: 1680px;
            margin: 0 auto;
            padding: 10px;
            padding-bottom: 80px; /* –î–ª—è PWA –±–∞–Ω–Ω–µ—Ä–∞ */
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(26, 35, 126, 0.9);
            padding: 12px 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border: 2px solid var(--secondary);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 32px;
            color: var(--gold);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .logo h1 {
            font-size: 24px;
            background: linear-gradient(45deg, var(--gold), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .currency {
            display: flex;
            gap: 15px;
        }

        .gold, .silver {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s;
            min-width: 120px;
            justify-content: center;
        }

        .gold:hover, .silver:hover {
            transform: translateY(-2px);
        }

        .gold {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: #000;
        }

        .silver {
            background: linear-gradient(135deg, var(--silver), var(--silver-dark));
            color: #000;
        }

        .tabs-container {
            background: rgba(18, 18, 30, 0.9);
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            display: flex;
            align-items: center;
        }

        .tabs {
            display: flex;
            overflow-x: auto;
            scrollbar-width: none;
            flex: 1;
            scroll-behavior: smooth;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tabs-scroll {
            background: rgba(0, 0, 0, 0.4);
            border: none;
            color: white;
            width: 36px;
            height: 100%;
            cursor: pointer;
            transition: background 0.3s;
        }

        .tabs-scroll:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
            min-width: 120px;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .tab.active {
            border-bottom: 3px solid var(--secondary);
            background: rgba(255, 152, 0, 0.1);
            color: var(--secondary);
        }

        .tab i {
            margin-right: 8px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
            padding: 10px 5px 20px;
            min-height: 70vh;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .ideas-panel {
            background: linear-gradient(135deg, rgba(32, 32, 52, 0.9), rgba(14, 14, 28, 0.95));
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
        }

        .ideas-panel p {
            color: #cfcfd9;
            margin: 10px 0 20px;
        }

        .ideas-list {
            columns: 2;
            column-gap: 24px;
            margin-left: 20px;
        }

        .ideas-list li {
            break-inside: avoid;
            margin-bottom: 12px;
            padding-left: 6px;
        }

        .card {
            background: linear-gradient(135deg, rgba(40, 40, 60, 0.8), rgba(20, 20, 40, 0.9));
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border-color: var(--secondary);
        }

        .card-header {
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card-body {
            padding: 20px;
        }

        .avatar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 15px;
        }

        .avatar-option {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .avatar-option.active {
            border-color: var(--secondary);
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.4);
        }

        .avatar-display {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 42px;
            margin: 0 auto 15px;
        }

        .trade-list {
            display: grid;
            gap: 15px;
        }

        .trade-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .progress-list {
            display: grid;
            gap: 12px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            touch-action: manipulation; /* –î–ª—è PWA */
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26, 35, 126, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #388e3c);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .btn-gold {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: #000;
        }

        .btn-silver {
            background: linear-gradient(135deg, var(--silver), var(--silver-dark));
            color: #000;
        }

        .item-card {
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .item-rarity {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .rarity-common { background: var(--common); color: white; }
        .rarity-uncommon { background: var(--uncommon); color: white; }
        .rarity-rare { background: var(--rare); color: white; }
        .rarity-epic { background: var(--epic); color: white; }
        .rarity-legendary { background: var(--legendary); color: black; }

        .item-image {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .item-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            max-height: 120px;
            display: none;
        }

        .emoji-fallback {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        .item-name {
            padding: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
        }

        .item-actions {
            display: flex;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .item-action {
            flex: 1;
            padding: 10px;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 12px;
        }

        .item-action:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .clicker-container {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            margin: 20px 0;
        }

        .clicker-btn {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            border: none;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            margin: 20px;
            transition: transform 0.1s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
            touch-action: manipulation;
        }

        .clicker-btn:active {
            transform: scale(0.95);
        }

        .clicker-btn-gold {
            background: radial-gradient(circle, var(--gold), var(--gold-dark));
            color: #000;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
        }

        .clicker-btn-silver {
            background: radial-gradient(circle, var(--silver), var(--silver-dark));
            color: #000;
            box-shadow: 0 10px 30px rgba(192, 192, 192, 0.4);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .modal.active {
            display: flex;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(30, 30, 50, 0.95), rgba(20, 20, 40, 0.98));
            border-radius: 15px;
            width: 100%;
            max-width: 500px;
            border: 2px solid var(--secondary);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .modal-body {
            padding: 25px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 15px;
            background: rgba(0, 0, 0, 0.3);
        }

        .case-opening-area {
            text-align: center;
            padding: 20px;
        }

        .case-reel {
            position: relative;
            overflow: hidden;
            height: 120px;
            margin: 25px auto;
            border: 2px solid rgba(255, 152, 0, 0.4);
            border-radius: 12px;
            background: linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,152,0,0.08), rgba(255,255,255,0.03));
            max-width: 420px;
        }

        .case-reel::before {
            content: '';
            position: absolute;
            inset: 0;
            pointer-events: none;
            background: linear-gradient(90deg, rgba(0,0,0,0.7) 0%, transparent 20%, transparent 80%, rgba(0,0,0,0.7) 100%);
            z-index: 1;
        }

        .case-pointer {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 4px;
            background: var(--gold);
            transform: translateX(-50%);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
            z-index: 2;
        }

        .case-track {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 10px 16px;
            width: max-content;
            transform: translateX(0);
            transition: transform 2.2s cubic-bezier(0.1, 0.8, 0.15, 1);
        }

        .case-reel-item {
            width: 86px;
            min-width: 86px;
            height: 86px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255,255,255,0.15);
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--danger);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 16px;
            margin: 10px 0;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.2);
        }

        .admin-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--danger), #d32f2f);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            z-index: 100;
            transition: transform 0.3s;
        }

        .admin-btn:hover {
            transform: scale(1.1) rotate(15deg);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: linear-gradient(135deg, var(--success), #388e3c);
            color: white;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 400px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--danger), #d32f2f);
        }

        .notification.warning {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 5px;
            transition: width 0.5s;
        }

        .audio-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .audio-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(26, 35, 126, 0.9);
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* –ö–Ω–æ–ø–∫–∞ –ø–æ–≤–æ—Ä–æ—Ç–∞ */
        .rotate-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(26, 35, 126, 0.9);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            font-size: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* –ü–æ–≤–æ—Ä–æ—Ç —ç–∫—Ä–∞–Ω–∞ */
        body.rotated {
            transform: rotate(90deg);
            transform-origin: left top;
            width: 100vh;
            height: 100vw;
            overflow-x: hidden;
            position: absolute;
            top: 0;
            left: 100vw;
        }

        body.rotated .container {
            width: 100vw;
            height: 100vh;
            padding: 10px;
            overflow-y: auto;
        }

        /* –û—Ñ–ª–∞–π–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å */
        .offline-progress {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }

        /* –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è */
        .achievement-card {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .achievement-icon {
            font-size: 32px;
            color: var(--gold);
        }

        .achievement-progress {
            margin-top: 5px;
        }

        /* –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è */
        .quest-card {
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .quest-reward {
            color: var(--gold);
            font-weight: bold;
        }

        /* PvP –î—É—ç–ª–∏ */
        .duel-container {
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            margin: 20px 0;
        }

        .duel-timer {
            font-size: 48px;
            font-weight: bold;
            color: var(--secondary);
            margin: 20px 0;
        }

        .duel-player {
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin: 10px 0;
        }

        /* –ö–ª–∞–Ω—ã */
        .clan-card {
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .clan-level {
            color: var(--gold);
            font-weight: bold;
        }

        /* –ê—É–∫—Ü–∏–æ–Ω */
        .auction-timer {
            font-size: 24px;
            color: var(--danger);
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }

        .bid-input {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        /* 3D –ø—Ä–µ–≤—å—é */
        .preview-3d {
            width: 100%;
            height: 300px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .preview-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è PWA */
        @media (max-width: 768px) {
            .cards-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 10px;
            }

            .ideas-list {
                columns: 1;
            }
            
            .tab {
                padding: 12px 10px;
                font-size: 12px;
                min-width: 90px;
            }
            
            .clicker-btn {
                width: 140px;
                height: 140px;
                font-size: 16px;
            }
            
            .gold, .silver {
                min-width: 90px;
                font-size: 12px;
                padding: 6px 10px;
            }
            
            .header {
                padding: 10px 15px;
            }
            
            .modal-content {
                margin: 10px;
                max-height: 85vh;
            }
            
            /* –°–∫—Ä—ã–≤–∞–µ–º –∞–¥–º–∏–Ω –∫–Ω–æ–ø–∫—É –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
            .admin-btn {
                display: none;
            }
            
            /* –£–ª—É—á—à–∞–µ–º touch targets */
            .btn {
                padding: 12px 20px;
                min-height: 44px;
            }
            
            .item-action {
                padding: 15px 5px;
                min-height: 44px;
            }
        }

        @media (max-width: 480px) {
            .cards-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header {
                flex-direction: column;
                gap: 10px;
            }
            
            .currency {
                width: 100%;
                justify-content: space-between;
            }
            
            .tabs {
                overflow-x: auto;
            }
            
            .logo h1 {
                font-size: 18px;
            }
            
            .clicker-container {
                padding: 20px 10px;
            }
            
            .clicker-btn {
                width: 120px;
                height: 120px;
                margin: 10px;
            }
        }

        /* PWA: –ø–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω –Ω–∞ iOS */
        @supports (-webkit-touch-callout: none) {
            body {
                min-height: -webkit-fill-available;
            }
            
            .container {
                min-height: -webkit-fill-available;
            }
        }

        /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        .btn:active, .item-action:active, .tab:active {
            opacity: 0.8;
            transform: scale(0.98);
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ PWA */
        .pwa-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a2e 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.3s;
        }

        .pwa-loading.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.1);
            border-top: 5px solid var(--secondary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        /* AR —Ä–µ–∂–∏–º —Å—Ç–∏–ª–∏ */
        .ar-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            z-index: 2000;
        }

        .ar-controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 2001;
        }

        .ar-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(0,0,0,0.5);
            border: 2px solid white;
            color: white;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- PWA –∑–∞–≥—Ä—É–∑–∫–∞ -->
    <div class="pwa-loading" id="pwaLoading">
        <div class="loading-spinner"></div>
        <h2>–ó–∞–≥—Ä—É–∑–∫–∞ Standoff 2...</h2>
    </div>

    <!-- PWA –±–∞–Ω–Ω–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ -->
    <div class="pwa-install-banner" id="pwaInstallBanner">
        <div>
            <h3>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Standoff 2</h3>
            <p>–î–æ–±–∞–≤—å—Ç–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞</p>
        </div>
        <div>
            <button class="btn btn-success" onclick="installPWA()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
            <button class="pwa-close" onclick="closeInstallBanner()">√ó</button>
        </div>
    </div>

    <!-- –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ -->
    <div class="bg-animation" id="bgAnimation"></div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–≤–æ—Ä–æ—Ç–∞ -->
    <button class="rotate-btn" onclick="toggleRotate()">
        <i class="fas fa-rotate"></i>
    </button>
    
    <!-- –ê—É–¥–∏–æ –∫–æ–Ω—Ç—Ä–æ–ª—ã -->
    <div class="audio-controls">
        <button class="audio-btn" onclick="toggleMusic()" id="music-btn">
            <i class="fas fa-music"></i>
        </button>
        <button class="audio-btn" onclick="toggleSound()" id="sound-btn">
            <i class="fas fa-volume-up"></i>
        </button>
        <!-- –ö–Ω–æ–ø–∫–∞ AR —Ä–µ–∂–∏–º–∞ -->
        <button class="audio-btn" onclick="startARMode()" id="ar-btn" style="display: none;">
            <i class="fas fa-vr-cardboard"></i>
        </button>
    </div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">–£—Å–ø–µ—à–Ω–æ!</span>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-crosshairs logo-icon"></i>
                <h1>STANDOFF 2</h1>
            </div>
            <div class="currency">
                <div class="gold" onclick="showAd('gold')">
                    <i class="fas fa-coins"></i>
                    <span id="gold-amount">5000</span>
                </div>
                <div class="silver" onclick="showAd('silver')">
                    <i class="fas fa-coins"></i>
                    <span id="silver-amount">12500</span>
                </div>
                <!-- –ö—Ä–∏—Å—Ç–∞–ª–ª—ã (—Ç—Ä–µ—Ç—å—è –≤–∞–ª—é—Ç–∞) -->
                <div class="gold" style="background: linear-gradient(135deg, #9c27b0, #6a1b9a);" onclick="showAd('crystal')">
                    <i class="fas fa-gem"></i>
                    <span id="crystal-amount">50</span>
                </div>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs-container">
            <button class="tabs-scroll" onclick="scrollTabs(-220)" aria-label="–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏ –≤–ª–µ–≤–æ">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="tabs" id="tabs-scroll">
                <div class="tab active" data-tab="inventory">
                    <i class="fas fa-archive"></i>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
                </div>
                <div class="tab" data-tab="market">
                    <i class="fas fa-store"></i>–†—ã–Ω–æ–∫
                </div>
                <div class="tab" data-tab="cases">
                    <i class="fas fa-box-open"></i>–ö–µ–π—Å—ã
                </div>
                <div class="tab" data-tab="collections">
                    <i class="fas fa-layer-group"></i>–ö–æ–ª–ª–µ–∫—Ü–∏–∏
                </div>
                <div class="tab" data-tab="crafting">
                    <i class="fas fa-hammer"></i>–ö—Ä–∞—Ñ—Ç–∏–Ω–≥
                </div>
                <div class="tab" data-tab="clicker">
                    <i class="fas fa-mouse-pointer"></i>–ö–ª–∏–∫–µ—Ä
                </div>
                <div class="tab" data-tab="battlepass">
                    <i class="fas fa-shield-alt"></i>–ë–∞—Ç–ª –ø–∞—Å—Å
                </div>
                <div class="tab" data-tab="daily">
                    <i class="fas fa-calendar-day"></i>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ
                </div>
                <div class="tab" data-tab="achievements">
                    <i class="fas fa-trophy"></i>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                </div>
                <div class="tab" data-tab="duels">
                    <i class="fas fa-crosshairs"></i>–î—É—ç–ª–∏
                </div>
                <div class="tab" data-tab="trades">
                    <i class="fas fa-exchange-alt"></i>–û–±–º–µ–Ω—ã
                </div>
                <div class="tab" data-tab="clans">
                    <i class="fas fa-users"></i>–ö–ª–∞–Ω—ã
                </div>
                <div class="tab" data-tab="games">
                    <i class="fas fa-gamepad"></i>–ò–≥—Ä—ã
                </div>
                <div class="tab" data-tab="events">
                    <i class="fas fa-calendar-star"></i>–°–æ–±—ã—Ç–∏—è
                </div>
                <div class="tab" data-tab="auction">
                    <i class="fas fa-gavel"></i>–ê—É–∫—Ü–∏–æ–Ω
                </div>
                <div class="tab" data-tab="skins">
                    <i class="fas fa-images"></i>–°–∫–∏–Ω—ã
                </div>
                <div class="tab" data-tab="profile">
                    <i class="fas fa-id-badge"></i>–ü—Ä–æ—Ñ–∏–ª—å
                </div>
                <div class="tab" data-tab="ideas">
                    <i class="fas fa-lightbulb"></i>–ò–¥–µ–∏
                </div>
                <div class="tab" data-tab="settings">
                    <i class="fas fa-cog"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </div>
            </div>
            <button class="tabs-scroll" onclick="scrollTabs(220)" aria-label="–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏ –≤–ø—Ä–∞–≤–æ">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
        <div id="inventory" class="tab-content active">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2><i class="fas fa-archive"></i> –ú–æ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="openModal('promo-modal')">
                        <i class="fas fa-ticket-alt"></i> –ü—Ä–æ–º–æ–∫–æ–¥
                    </button>
                    <button class="btn btn-secondary" onclick="openModal('upload-skin-modal')">
                        <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫–∏–Ω
                    </button>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                <button class="btn" onclick="filterInventory('all')" id="filter-all">–í—Å–µ</button>
                <button class="btn" onclick="filterInventory('weapon')" id="filter-weapon">–û—Ä—É–∂–∏–µ</button>
                <button class="btn" onclick="filterInventory('knife')" id="filter-knife">–ù–æ–∂–∏</button>
                <button class="btn" onclick="filterInventory('gloves')" id="filter-gloves">–ü–µ—Ä—á–∞—Ç–∫–∏</button>
                <button class="btn" onclick="filterInventory('charm')" id="filter-charm">–ë—Ä–µ–ª–∫–∏</button>
                <button class="btn" onclick="filterInventory('sticker')" id="filter-sticker">–ù–∞–∫–ª–µ–π–∫–∏</button>
            </div>
            
            <div class="cards-grid" id="inventory-items">
                <!-- –ü—Ä–µ–¥–º–µ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –†—ã–Ω–æ–∫ -->
        <div id="market" class="tab-content">
            <h2><i class="fas fa-store"></i> –û–Ω–ª–∞–π–Ω —Ä—ã–Ω–æ–∫</h2>
            <p style="color: #aaa; margin-top: 10px;">–¢–æ—Ä–≥—É–π—Ç–µ —Å–∫–∏–Ω–∞–º–∏ –≤ –∂–∏–≤–æ–º –æ–Ω–ª–∞–π–Ω-—Ä—ã–Ω–∫–µ –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Ü–µ–Ω–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.</p>
            
            <div style="margin: 20px 0;">
                <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                    <input type="text" id="market-search" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤...">
                    <button class="btn btn-secondary" onclick="searchMarket()">
                        <i class="fas fa-search"></i> –ü–æ–∏—Å–∫
                    </button>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                    <button class="btn btn-success" onclick="refreshMarket()">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                    <button class="btn btn-primary" onclick="sellAllItems()">
                        <i class="fas fa-coins"></i> –ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë
                    </button>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <button class="btn btn-secondary" onclick="changeMarketPage(-1)">
                        <i class="fas fa-chevron-left"></i> –ù–∞–∑–∞–¥
                    </button>
                    <span id="market-page-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1</span>
                    <button class="btn btn-secondary" onclick="changeMarketPage(1)">
                        –í–ø–µ—Ä—ë–¥ <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
            
            <div class="cards-grid" id="market-items">
                <!-- –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ö–µ–π—Å—ã -->
        <div id="cases" class="tab-content">
            <h2><i class="fas fa-box-open"></i> –ö–µ–π—Å—ã</h2>
            
            <div class="cards-grid" id="cases-grid">
                <!-- –ö–µ–π—Å—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ö–æ–ª–ª–µ–∫—Ü–∏–∏ -->
        <div id="collections" class="tab-content">
            <h2><i class="fas fa-layer-group"></i> –ö–æ–ª–ª–µ–∫—Ü–∏–∏</h2>
            <p style="color: #aaa; margin-top: 10px;">–°–æ–±–∏—Ä–∞–π—Ç–µ –Ω–∞–±–æ—Ä—ã –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã –∑–∞ –ø–æ–ª–Ω—ã–π —Å–µ—Ç.</p>
            <div class="cards-grid" id="collections-grid">
                <!-- –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ö—Ä–∞—Ñ—Ç–∏–Ω–≥ -->
        <div id="crafting" class="tab-content">
            <h2><i class="fas fa-hammer"></i> –ö—Ä–∞—Ñ—Ç–∏–Ω–≥</h2>
            
            <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>–°–∏—Å—Ç–µ–º–∞ –∫—Ä–∞—Ñ—Ç–∞</h3>
                <p>–û–±—ä–µ–¥–∏–Ω—è–π—Ç–µ –ø—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö:</p>
                <ul style="margin: 10px 0 20px 20px;">
                    <li>3 –æ–±—ã—á–Ω—ã—Ö ‚Üí 1 –Ω–µ–æ–±—ã—á–Ω—ã–π</li>
                    <li>3 –Ω–µ–æ–±—ã—á–Ω—ã—Ö ‚Üí 1 —Ä–µ–¥–∫–∏–π</li>
                    <li>3 —Ä–µ–¥–∫–∏—Ö ‚Üí 1 —ç–ø–∏—á–µ—Å–∫–∏–π</li>
                    <li>3 —ç–ø–∏—á–µ—Å–∫–∏—Ö ‚Üí 1 –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π</li>
                </ul>
                <button class="btn btn-primary" onclick="openCrafting()">
                    <i class="fas fa-hammer"></i> –û—Ç–∫—Ä—ã—Ç—å –∫—Ä–∞—Ñ—Ç
                </button>
            </div>
            
            <div class="cards-grid" id="crafting-items">
                <!-- –ü—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è –∫—Ä–∞—Ñ—Ç–∞ -->
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ö–ª–∏–∫–µ—Ä -->
        <div id="clicker" class="tab-content">
            <div class="clicker-container">
                <h2><i class="fas fa-mouse-pointer"></i> –ö–ª–∏–∫–µ—Ä –≤–∞–ª—é—Ç—ã</h2>
                <p>–ö–ª–∏–∫–∞–π—Ç–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∫–∞!</p>
                
                <div style="display: flex; justify-content: center; gap: 50px; margin: 40px 0; flex-wrap: wrap;">
                    <div style="text-align: center;">
                        <button class="clicker-btn clicker-btn-gold" onclick="clickGold()">
                            <i class="fas fa-coins" style="font-size: 48px;"></i>
                            <span>–ö–ª–∏–∫!</span>
                            <span style="font-size: 14px;">+10 –≥–æ–ª–¥—ã</span>
                        </button>
                        <div style="margin-top: 20px;">
                            <h4>–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤: <span id="gold-clicks">0</span></h4>
                            <h4>–í—Å–µ–≥–æ –≥–æ–ª–¥—ã: <span id="total-gold">0</span></h4>
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button class="clicker-btn clicker-btn-silver" onclick="clickSilver()">
                            <i class="fas fa-coins" style="font-size: 48px;"></i>
                            <span>–ö–ª–∏–∫!</span>
                            <span style="font-size: 14px;">+25 —Å–µ—Ä–µ–±—Ä–∞</span>
                        </button>
                        <div style="margin-top: 20px;">
                            <h4>–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤: <span id="silver-clicks">0</span></h4>
                            <h4>–í—Å–µ–≥–æ —Å–µ—Ä–µ–±—Ä–∞: <span id="total-silver">0</span></h4>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 40px;">
                    <h3>–û–±–º–µ–Ω –≤–∞–ª—é—Ç—ã</h3>
                    <p>1000 —Å–µ—Ä–µ–±—Ä–∞ = 100 –≥–æ–ª–¥—ã</p>
                    <button class="btn btn-primary" onclick="exchangeCurrency()">
                        <i class="fas fa-exchange-alt"></i> –û–±–º–µ–Ω—è—Ç—å 1000 —Å–µ—Ä–µ–±—Ä–∞ –Ω–∞ 100 –≥–æ–ª–¥—ã
                    </button>
                    <button class="btn btn-secondary" onclick="exchangeGoldToSilver()" style="margin-left: 10px;">
                        <i class="fas fa-exchange-alt"></i> –û–±–º–µ–Ω—è—Ç—å 10 –≥–æ–ª–¥—ã –Ω–∞ 100 —Å–µ—Ä–µ–±—Ä–∞
                    </button>
                </div>
                
                <!-- –ê–≤—Ç–æ-—Ñ–µ—Ä–º–∞ –±–æ—Ç–æ–≤ -->
                <div style="margin-top: 40px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                    <h3><i class="fas fa-robot"></i> –ê–≤—Ç–æ-—Ñ–µ—Ä–º–∞</h3>
                    <p>–ë–æ—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –¥–∞–∂–µ –∫–æ–≥–¥–∞ –∏–≥—Ä–∞ –∑–∞–∫—Ä—ã—Ç–∞!</p>
                    
                    <div class="cards-grid" style="margin-top: 20px;">
                        <div class="card">
                            <div class="card-header">
                                <h4>–ë–æ—Ç –ù–æ–≤–∏—á–æ–∫</h4>
                            </div>
                            <div class="card-body">
                                <p>+10 —Å–µ—Ä–µ–±—Ä–∞/–º–∏–Ω—É—Ç—É</p>
                                <p>–°—Ç–æ–∏–º–æ—Å—Ç—å: 1000 —Å–µ—Ä–µ–±—Ä–∞</p>
                                <button class="btn btn-silver" onclick="buyBot('novice')" id="bot-novice-btn">
                                    <i class="fas fa-robot"></i> –ö—É–ø–∏—Ç—å
                                </button>
                                <p style="margin-top: 10px;" id="bot-novice-count">–ö—É–ø–ª–µ–Ω–æ: 0</p>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h4>–ë–æ—Ç –ü—Ä–æ—Ñ–∏</h4>
                            </div>
                            <div class="card-body">
                                <p>+100 —Å–µ—Ä–µ–±—Ä–∞/–º–∏–Ω—É—Ç—É</p>
                                <p>–°—Ç–æ–∏–º–æ—Å—Ç—å: 5000 —Å–µ—Ä–µ–±—Ä–∞</p>
                                <button class="btn btn-silver" onclick="buyBot('pro')" id="bot-pro-btn">
                                    <i class="fas fa-robot"></i> –ö—É–ø–∏—Ç—å
                                </button>
                                <p style="margin-top: 10px;" id="bot-pro-count">–ö—É–ø–ª–µ–Ω–æ: 0</p>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h4>–ë–æ—Ç –ú–∞—Ñ–∏—è</h4>
                            </div>
                            <div class="card-body">
                                <p>+500 —Å–µ—Ä–µ–±—Ä–∞/–º–∏–Ω—É—Ç—É</p>
                                <p>–°—Ç–æ–∏–º–æ—Å—Ç—å: 25000 —Å–µ—Ä–µ–±—Ä–∞</p>
                                <button class="btn btn-silver" onclick="buyBot('mafia')" id="bot-mafia-btn">
                                    <i class="fas fa-robot"></i> –ö—É–ø–∏—Ç—å
                                </button>
                                <p style="margin-top: 10px;" id="bot-mafia-count">–ö—É–ø–ª–µ–Ω–æ: 0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="offline-progress" style="margin-top: 20px;">
                        <h4>–û—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥</h4>
                        <p id="offline-earnings">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        <button class="btn btn-success" onclick="claimOfflineEarnings()">
                            <i class="fas fa-download"></i> –ó–∞–±—Ä–∞—Ç—å –æ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ë–∞—Ç–ª –ü–∞—Å—Å -->
        <div id="battlepass" class="tab-content">
            <h2><i class="fas fa-shield-alt"></i> –ë–æ–µ–≤–æ–π –ø—Ä–æ–ø—É—Å–∫</h2>
            <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–ø—É—Å–∫–∞: <span id="battlepass-level">1</span></h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="battlepass-progress" style="width: 0%;"></div>
                </div>
                <p>–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∏ –ø–ª–∞—Ç–Ω—ã–µ —É—Ä–æ–≤–Ω–∏.</p>
                <button class="btn btn-success" onclick="togglePremiumPass()" id="battlepass-premium-btn">
                    <i class="fas fa-star"></i> –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–º–∏—É–º
                </button>
            </div>
            <div class="progress-list" id="battlepass-quests">
                <!-- –ó–∞–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
            <div class="cards-grid" id="battlepass-rewards">
                <!-- –ù–∞–≥—Ä–∞–¥—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã -->
        <div id="daily" class="tab-content">
            <h2><i class="fas fa-calendar-day"></i> –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã</h2>
            
            <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>–¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è: –¥–µ–Ω—å <span id="current-day">1</span></h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="daily-progress" style="width: 14%;"></div>
                </div>
                <p>–ó–∞—Ö–æ–¥–∏—Ç–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥!</p>
            </div>
            
            <!-- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è -->
            <div style="margin: 30px 0;">
                <h3><i class="fas fa-tasks"></i> –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h3>
                <div id="daily-quests">
                    <!-- –ó–∞–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <div class="cards-grid" id="daily-rewards">
                <!-- –ù–∞–≥—Ä–∞–¥—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <div style="text-align: center; margin-top: 40px;">
                <button class="btn btn-success btn-lg" onclick="claimDailyReward()" id="daily-claim-btn">
                    <i class="fas fa-gift"></i> –ü–æ–ª—É—á–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –Ω–∞–≥—Ä–∞–¥—É
                </button>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
        <div id="achievements" class="tab-content">
            <h2><i class="fas fa-trophy"></i> –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
            
            <div style="display: flex; gap: 10px; margin: 20px 0; flex-wrap: wrap;">
                <button class="btn" onclick="filterAchievements('all')" id="achievement-filter-all">–í—Å–µ</button>
                <button class="btn" onclick="filterAchievements('completed')" id="achievement-filter-completed">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</button>
                <button class="btn" onclick="filterAchievements('in-progress')" id="achievement-filter-progress">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</button>
                <button class="btn" onclick="filterAchievements('secret')" id="achievement-filter-secret">–°–µ–∫—Ä–µ—Ç–Ω—ã–µ</button>
            </div>
            
            <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                <input type="text" id="achievement-search" class="form-control" placeholder="–ü–æ–∏—Å–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π...">
                <button class="btn btn-secondary" onclick="searchAchievements()">
                    <i class="fas fa-search"></i> –ü–æ–∏—Å–∫
                </button>
            </div>
            
            <div id="achievements-list">
                <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin-top: 40px;">
                <h3>–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                    <div>
                        <h4>–ü—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" id="achievement-progress" style="width: 0%;"></div>
                        </div>
                        <p id="achievement-count">0/50 –∑–∞–≤–µ—Ä—à–µ–Ω–æ</p>
                    </div>
                    
                    <div>
                        <h4>–í—Å–µ–≥–æ –æ—á–∫–æ–≤ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</h4>
                        <h2 id="achievement-points">0</h2>
                    </div>
                    
                    <div>
                        <h4>–†–µ–¥–∫–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</h4>
                        <p id="achievement-rarity">–ù–æ–≤–∏—á–æ–∫</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –î—É—ç–ª–∏ -->
        <div id="duels" class="tab-content">
            <h2><i class="fas fa-crosshairs"></i> PvP –î—É—ç–ª–∏</h2>
            
            <div class="duel-container">
                <h3>–ë—ã—Å—Ç—Ä–∞—è –¥—É—ç–ª—å</h3>
                <p>–°—Ä–∞–∑–∏—Ç–µ—Å—å —Å –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–æ–º –≤ –∫–ª–∏–∫–µ—Ä-–±–∞—Ç—Ç–ª–µ!</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 30px 0;">
                    <div class="duel-player">
                        <h4>–í—ã</h4>
                        <div style="font-size: 48px; font-weight: bold; margin: 20px 0;" id="player1-clicks">0</div>
                        <button class="btn btn-primary" onclick="duelClick(1)" id="player1-btn">
                            <i class="fas fa-mouse-pointer"></i> –ö–ª–∏–∫–∞–π!
                        </button>
                    </div>
                    
                    <div class="duel-player">
                        <h4>–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</h4>
                        <div style="font-size: 48px; font-weight: bold; margin: 20px 0;" id="player2-clicks">0</div>
                        <button class="btn btn-danger" onclick="duelClick(2)" id="player2-btn">
                            <i class="fas fa-mouse-pointer"></i> –ö–ª–∏–∫–∞–π!
                        </button>
                    </div>
                </div>
                
                <div class="duel-timer" id="duel-timer">10</div>
                
                <div style="margin: 20px 0;">
                    <h4>–°—Ç–∞–≤–∫–∞:</h4>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button class="btn" onclick="setDuelBet(100)">100 —Å–µ—Ä–µ–±—Ä–∞</button>
                        <button class="btn" onclick="setDuelBet(500)">500 —Å–µ—Ä–µ–±—Ä–∞</button>
                        <button class="btn" onclick="setDuelBet(1000)">1000 —Å–µ—Ä–µ–±—Ä–∞</button>
                        <button class="btn" onclick="setDuelBet(5000)">5000 —Å–µ—Ä–µ–±—Ä–∞</button>
                    </div>
                    <p style="margin-top: 10px;">–¢–µ–∫—É—â–∞—è —Å—Ç–∞–≤–∫–∞: <span id="current-bet">0</span> —Å–µ—Ä–µ–±—Ä–∞</p>
                </div>
                
                <button class="btn btn-success btn-lg" onclick="startDuel()" id="start-duel-btn">
                    <i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –¥—É—ç–ª—å
                </button>
                
                <button class="btn btn-danger" onclick="findRandomOpponent()" style="margin-top: 10px;">
                    <i class="fas fa-random"></i> –ù–∞–π—Ç–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
                </button>
                
                <!-- –ò—Å—Ç–æ—Ä–∏—è –¥—É—ç–ª–µ–π -->
                <div style="margin-top: 40px;">
                    <h4>–ò—Å—Ç–æ—Ä–∏—è –¥—É—ç–ª–µ–π</h4>
                    <div id="duel-history">
                        <!-- –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –û–±–º–µ–Ω—ã -->
        <div id="trades" class="tab-content">
            <h2><i class="fas fa-exchange-alt"></i> –û–±–º–µ–Ω—ã</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div class="card">
                    <div class="card-header">
                        <h3>–°–æ–∑–¥–∞—Ç—å –æ–±–º–µ–Ω</h3>
                    </div>
                    <div class="card-body">
                        <select id="trade-item-select" class="form-control"></select>
                        <select id="trade-want-select" class="form-control">
                            <option value="weapon">–û—Ä—É–∂–∏–µ</option>
                            <option value="knife">–ù–æ–∂</option>
                            <option value="gloves">–ü–µ—Ä—á–∞—Ç–∫–∏</option>
                            <option value="charm">–ë—Ä–µ–ª–æ–∫</option>
                            <option value="sticker">–ù–∞–∫–ª–µ–π–∫–∞</option>
                        </select>
                        <input type="text" id="trade-note" class="form-control" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                        <button class="btn btn-primary" onclick="createTrade()" style="width: 100%; margin-top: 10px;">
                            <i class="fas fa-plus-circle"></i> –°–æ–∑–¥–∞—Ç—å –æ–±–º–µ–Ω
                        </button>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>–ú–æ–∏ –æ–±–º–µ–Ω—ã</h3>
                    </div>
                    <div class="card-body">
                        <div class="trade-list" id="trade-list">
                            <!-- –û–±–º–µ–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ö–ª–∞–Ω—ã -->
        <div id="clans" class="tab-content">
            <h2><i class="fas fa-users"></i> –ö–ª–∞–Ω—ã</h2>
            
            <div style="display: flex; gap: 15px; margin: 20px 0;">
                <button class="btn btn-primary" onclick="openModal('create-clan-modal')">
                    <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –∫–ª–∞–Ω
                </button>
                <button class="btn btn-secondary" onclick="openModal('join-clan-modal')">
                    <i class="fas fa-sign-in-alt"></i> –í—Å—Ç—É–ø–∏—Ç—å –≤ –∫–ª–∞–Ω
                </button>
            </div>
            
            <!-- –¢–µ–∫—É—â–∏–π –∫–ª–∞–Ω -->
            <div id="current-clan" style="display: none;">
                <div class="clan-card">
                    <h3 id="clan-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞</h3>
                    <p>–£—Ä–æ–≤–µ–Ω—å: <span class="clan-level" id="clan-level">1</span></p>
                    <p>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: <span id="clan-members">1/50</span></p>
                    <p>–û—á–∫–∏ –∫–ª–∞–Ω–∞: <span id="clan-points">0</span></p>
                    <div style="margin-top: 20px;">
                        <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∞–Ω–∞</h4>
                        <input type="text" id="clan-tag" class="form-control" placeholder="–¢–µ–≥ –∫–ª–∞–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä ST2)">
                        <input type="text" id="clan-description" class="form-control" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞–Ω–∞">
                        <select id="clan-privacy" class="form-control">
                            <option value="open">–û—Ç–∫—Ä—ã—Ç—ã–π</option>
                            <option value="invite">–ü–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—é</option>
                        </select>
                        <button class="btn btn-success" onclick="saveClanSettings()" style="margin-top: 10px;">
                            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                        </button>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4>–ö–ª–∞–Ω–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è</h4>
                        <div id="clan-quests">
                            <!-- –ö–ª–∞–Ω–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è -->
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4>–£—á–∞—Å—Ç–Ω–∏–∫–∏</h4>
                        <div id="clan-members-list">
                            <!-- –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ -->
                        </div>
                    </div>
                    
                    <button class="btn btn-danger" onclick="leaveClan()" style="margin-top: 20px;">
                        <i class="fas fa-sign-out-alt"></i> –ü–æ–∫–∏–Ω—É—Ç—å –∫–ª–∞–Ω
                    </button>
                </div>
            </div>
            
            <!-- –ë–µ–∑ –∫–ª–∞–Ω–∞ -->
            <div id="no-clan">
                <div style="text-align: center; padding: 40px; background: rgba(0,0,0,0.3); border-radius: 15px;">
                    <i class="fas fa-users" style="font-size: 64px; color: #aaa; margin-bottom: 20px;"></i>
                    <h3>–í—ã –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –∫–ª–∞–Ω–µ</h3>
                    <p>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ –∫–ª–∞–Ω—É, —á—Ç–æ–±—ã —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –∫–ª–∞–Ω–æ–≤—ã—Ö –≤–æ–π–Ω–∞—Ö –∏ –ø–æ–ª—É—á–∞—Ç—å —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã!</p>
                    <div style="margin-top: 20px; max-width: 420px; margin-left: auto; margin-right: auto;">
                        <input type="text" id="clan-search" class="form-control" placeholder="–ù–∞–π—Ç–∏ –∫–ª–∞–Ω –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é">
                        <button class="btn btn-secondary" onclick="searchClans()" style="margin-top: 10px;">
                            <i class="fas fa-search"></i> –ù–∞–π—Ç–∏ –∫–ª–∞–Ω
                        </button>
                        <div id="clan-search-results" style="margin-top: 15px;"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ò–≥—Ä—ã -->
        <div id="games" class="tab-content">
            <h2><i class="fas fa-gamepad"></i> –û–Ω–ª–∞–π–Ω –∏–≥—Ä—ã</h2>
            <p style="color: #aaa;">–û—Ñ–ª–∞–π–Ω –¥–µ–º–æ –º–∞—Ç—á–º–µ–π–∫–∏–Ω–≥–∞ —Å –±—ã—Å—Ç—Ä—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏.</p>
            <div class="cards-grid" id="games-grid">
                <!-- –ú–∞—Ç—á–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –°–æ–±—ã—Ç–∏—è -->
        <div id="events" class="tab-content">
            <h2><i class="fas fa-calendar-star"></i> –¢—É—Ä–Ω–∏—Ä—ã –∏ —Å–æ–±—ã—Ç–∏—è</h2>
            <div class="cards-grid" id="events-grid">
                <!-- –°–æ–±—ã—Ç–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ê—É–∫—Ü–∏–æ–Ω -->
        <div id="auction" class="tab-content">
            <h2><i class="fas fa-gavel"></i> –ê—É–∫—Ü–∏–æ–Ω</h2>
            
            <div style="display: flex; gap: 15px; margin: 20px 0;">
                <button class="btn btn-primary" onclick="openModal('create-auction-modal')">
                    <i class="fas fa-plus"></i> –í—ã—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω
                </button>
                <button class="btn btn-secondary" onclick="refreshAuction()">
                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            
            <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ –∞—É–∫—Ü–∏–æ–Ω—ã -->
            <div style="margin: 30px 0;">
                <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –∞—É–∫—Ü–∏–æ–Ω—ã</h3>
                <div id="active-auctions">
                    <!-- –ê—É–∫—Ü–∏–æ–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <!-- –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∞—É–∫—Ü–∏–æ–Ω—ã -->
            <div style="margin: 30px 0;">
                <h3>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∞—É–∫—Ü–∏–æ–Ω—ã</h3>
                <div id="completed-auctions">
                    <!-- –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∞—É–∫—Ü–∏–æ–Ω—ã -->
                </div>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –°–∫–∏–Ω—ã -->
        <div id="skins" class="tab-content">
            <h2><i class="fas fa-images"></i> –ì–∞–ª–µ—Ä–µ—è —Å–∫–∏–Ω–æ–≤</h2>
            
            <div style="margin: 20px 0;">
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="btn" onclick="filterSkins('all')" id="skin-filter-all">–í—Å–µ —Å–∫–∏–Ω—ã</button>
                    <button class="btn" onclick="filterSkins('default')" id="skin-filter-default">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ</button>
                    <button class="btn" onclick="filterSkins('custom')" id="skin-filter-custom">–ú–æ–∏ —Å–∫–∏–Ω—ã</button>
                    <button class="btn" onclick="filterSkins('animated')" id="skin-filter-animated">–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</button>
                    <button class="btn" onclick="filterSkins('limited')" id="skin-filter-limited">–õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</button>
                </div>
                
                <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                    <input type="text" id="skin-search" class="form-control" placeholder="–ü–æ–∏—Å–∫ —Å–∫–∏–Ω–æ–≤...">
                    <button class="btn btn-secondary" onclick="searchSkins()">
                        <i class="fas fa-search"></i> –ü–æ–∏—Å–∫
                    </button>
                </div>
            </div>
            
            <!-- 3D –ø—Ä–µ–≤—å—é -->
            <div class="preview-3d" id="3d-preview">
                <div style="text-align: center;">
                    <i class="fas fa-cube" style="font-size: 64px; color: #aaa;"></i>
                    <p>3D –ø—Ä–µ–≤—å—é —Å–∫–∏–Ω–∞</p>
                    <p style="font-size: 12px; color: #aaa;">–í—ã–±–µ—Ä–∏—Ç–µ —Å–∫–∏–Ω –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</p>
                </div>
            </div>
            
            <div class="preview-controls" id="3d-controls" style="display: none;">
                <button class="btn" onclick="rotateSkin('left')">
                    <i class="fas fa-rotate-left"></i>
                </button>
                <button class="btn" onclick="toggleSkinAnimation()">
                    <i class="fas fa-play"></i> –ê–Ω–∏–º–∞—Ü–∏—è
                </button>
                <button class="btn" onclick="rotateSkin('right')">
                    <i class="fas fa-rotate-right"></i>
                </button>
                <button class="btn" onclick="resetSkinView()">
                    <i class="fas fa-redo"></i>
                </button>
            </div>
            
            <div class="cards-grid" id="skins-grid">
                <!-- –°–∫–∏–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ü—Ä–æ—Ñ–∏–ª—å -->
        <div id="profile" class="tab-content">
            <h2><i class="fas fa-id-badge"></i> –ü—Ä–æ—Ñ–∏–ª—å</h2>
            <div class="cards-grid">
                <div class="card">
                    <div class="card-header">
                        <h3>–ê–≤–∞—Ç–∞—Ä</h3>
                    </div>
                    <div class="card-body" style="text-align: center;">
                        <div class="avatar-display" id="profile-avatar-display">üéØ</div>
                        <input type="file" id="avatar-file-input" class="form-control" accept=".png,.jpg,.jpeg" style="margin-bottom: 15px;">
                        <div class="avatar-grid" id="avatar-grid">
                            <!-- –ê–≤–∞—Ç–∞—Ä–∫–∏ -->
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>–î–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞</h3>
                    </div>
                    <div class="card-body">
                        <input type="text" id="profile-name" class="form-control" placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º">
                        <input type="text" id="profile-id" class="form-control" placeholder="–ò–≥—Ä–æ–≤–æ–π ID" readonly>
                        <button class="btn btn-primary" onclick="changeNameFromProfile()" style="margin-top: 10px;">
                            <i class="fas fa-edit"></i> –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫
                        </button>
                        <button class="btn btn-secondary" onclick="changeIdWithAd()" style="margin-top: 10px;">
                            <i class="fas fa-sync-alt"></i> –ò–∑–º–µ–Ω–∏—Ç—å ID –∑–∞ —Ä–µ–∫–ª–∞–º—É
                        </button>
                        <div style="margin-top: 20px;">
                            <h4>–£—Ä–æ–≤–µ–Ω—å</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" id="level-progress" style="width: 0%;"></div>
                            </div>
                            <p>–£—Ä–æ–≤–µ–Ω—å <span id="profile-level">1</span> ‚Ä¢ –û–ø—ã—Ç <span id="profile-exp">0</span>/<span id="profile-exp-next">1000</span></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è</h3>
                    </div>
                    <div class="card-body">
                        <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å—Ç–∏–∫–µ—Ä—ã, –±—Ä–µ–ª–æ–∫–∏ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è.</p>
                        <div style="display: grid; gap: 10px; margin-top: 15px;">
                            <button class="btn btn-secondary" onclick="applyCustomization('sticker')">
                                <i class="fas fa-sticky-note"></i> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∏–∫–µ—Ä
                            </button>
                            <button class="btn btn-secondary" onclick="applyCustomization('charm')">
                                <i class="fas fa-gem"></i> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—Ä–µ–ª–æ–∫
                            </button>
                            <button class="btn btn-secondary" onclick="applyCustomization('title')">
                                <i class="fas fa-award"></i> –í—ã–±—Ä–∞—Ç—å —Ç–∏—Ç—É–ª
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ò–¥–µ–∏ -->
        <div id="ideas" class="tab-content">
            <h2><i class="fas fa-lightbulb"></i> 50 –∏–¥–µ–π –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è</h2>
            <div class="ideas-panel">
                <p>–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–¥–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∏–≥—Ä—É –∫–∞–∫ –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä –¥–ª—è –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.</p>
                <ol class="ideas-list">
                    <li>–ì–ª–∞–≤–Ω—ã–π –±–∞–Ω–Ω–µ—Ä —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∫–æ–º–∞–Ω–¥—ã/–∫–ª–∞–Ω–∞ –≤ —Å—Ç–∏–ª–µ Standoff 2.</li>
                    <li>–°—á—ë—Ç—á–∏–∫ K/D —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–¥—Å—á—ë—Ç–æ–º.</li>
                    <li>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–Ω–≥–∞ –ø–æ —Ç–µ–∫—É—â–µ–º—É MMR.</li>
                    <li>–¢–∞–π–º–µ—Ä –¥–æ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–µ–∑–æ–Ω–∞.</li>
                    <li>–ë–ª–æ–∫ ¬´–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞¬ª: K/D, Winrate, MVP, HS%.</li>
                    <li>–¢–æ–ø-5 –ª—é–±–∏–º—ã—Ö –æ—Ä—É–∂–∏–π —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏.</li>
                    <li>–°–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç —Å –±—ã—Å—Ç—Ä—ã–º–∏ —Å–æ–≤–µ—Ç–∞–º–∏.</li>
                    <li>–ö–Ω–æ–ø–∫–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∫–∞—Ä—Ç—ã –¥–ª—è —Ä–∞–∑–º–∏–Ω–∫–∏.</li>
                    <li>–ú–∏–Ω–∏-–≥–∞–π–¥ –ø–æ —Ä–æ–ª—è–º: entry, support, sniper.</li>
                    <li>–°–µ–∫—Ü–∏—è —Ä–∞—Å–∫–∏–¥–æ–∫: –¥—ã–º, —Ñ–ª–µ—à, –º–æ–ª–æ—Ç–æ–≤.</li>
                    <li>–¢–∞–±–ª–∏—Ü–∞ –ª—É—á—à–∏—Ö –ø–æ–∑–∏—Ü–∏–π –∞—Ç–∞–∫–∏ –∏ –∑–∞—â–∏—Ç—ã.</li>
                    <li>–ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏—Ü–µ–ª–∞ (crosshair presets).</li>
                    <li>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–µ–ª–ª–µ–Ω–¥–∂–∞.</li>
                    <li>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–π –∏–≥—Ä–æ–∫–∞.</li>
                    <li>–¢—Ä–µ–∫–µ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –±–∞—Ç—Ç–ª-–ø–∞—Å—Å–∞.</li>
                    <li>Wishlist —Å–∫–∏–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—á–µ—à—å –ø–æ–ª—É—á–∏—Ç—å.</li>
                    <li>–¢–∞–±–ª–∏—Ü–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è —Å —Ä–µ–¥–∫–æ—Å—Ç—å—é –∏ —Ü–µ–Ω–æ–π.</li>
                    <li>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞ –ø—Ä–∏ —Ç—Ä–µ–π–¥–µ.</li>
                    <li>–õ–µ–Ω—Ç–∞ –ø–∞—Ç—á–Ω–æ—É—Ç–æ–≤ —Å –¥–∞—Ç–∞–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.</li>
                    <li>–õ–µ–Ω—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å–∞–º–æ–≥–æ —Å–∞–π—Ç–∞.</li>
                    <li>–ö–∞—Ä—Ç–æ—á–∫–∏ –¥—Ä—É–∑–µ–π –∏ —Ç–∏–º–º–µ–π—Ç–æ–≤ —Å —Ä–æ–ª—å—é.</li>
                    <li>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∫–ª–∞–Ω–æ–≤—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫.</li>
                    <li>–§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ –∫–ª–∞–Ω.</li>
                    <li>–¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–ª–∞–Ω-–º–∞—Ç—á–µ–π.</li>
                    <li>–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤ –∫–ª–∞–Ω–∞.</li>
                    <li>–°—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ù–∞–±–æ—Ä –≤ –∫–æ–º–∞–Ω–¥—É¬ª —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏.</li>
                    <li>–ë–ª–æ–∫ ¬´–ò–≥—Ä–æ–∫ –Ω–µ–¥–µ–ª–∏¬ª.</li>
                    <li>–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –±–µ–π–¥–∂–µ–π.</li>
                    <li>–õ–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞ —Å –∞–≤–∞—Ç–∞—Ä–æ–º –∏ –±–∏–æ.</li>
                    <li>–†–∞–∑–¥–µ–ª ¬´–õ—É—á—à–∏–µ –º–æ–º–µ–Ω—Ç—ã¬ª —Å –∫–ª–∏–ø–∞–º–∏.</li>
                    <li>YouTube-–±–ª–æ–∫ —Å —Ö–∞–π–ª–∞–π—Ç–∞–º–∏ Standoff 2.</li>
                    <li>FAQ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ –∏ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã.</li>
                    <li>–ß–µ–∫–ª–∏—Å—Ç ¬´–°–æ–≤–µ—Ç—ã –Ω–æ–≤–∏—á–∫–∞–º¬ª.</li>
                    <li>–¢–æ–ø-10 –æ—à–∏–±–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –∏ —Å–ø–æ—Å–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</li>
                    <li>–ì–∞–π–¥ –ø–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∏–ª–µ–π.</li>
                    <li>–¢–∞–±–ª–∏—Ü–∞ ¬´–æ—Ä—É–∂–∏–µ vs –¥–∏—Å—Ç–∞–Ω—Ü–∏—è¬ª.</li>
                    <li>–ú–∏–Ω–∏-—Ç–µ—Å—Ç ¬´–ö–∞–∫–∞—è —Ä–æ–ª—å —Ç–µ–±–µ –ø–æ–¥—Ö–æ–¥–∏—Ç¬ª.</li>
                    <li>–†–∞–Ω–¥–æ–º–∞–π–∑–µ—Ä –æ—Ä—É–∂–∏—è –Ω–∞ —Ä–∞—É–Ω–¥.</li>
                    <li>–ö–Ω–æ–ø–∫–∞ ¬´–°–ª—É—á–∞–π–Ω–∞—è —Ç–∞–∫—Ç–∏–∫–∞ –Ω–∞ —Ä–∞—É–Ω–¥¬ª.</li>
                    <li>–†–∞–∑–¥–µ–ª —ç–∫–æ–Ω–æ–º–∏–∫–∏: eco/force/buy.</li>
                    <li>–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–≤–µ—Ç–ª–æ–π –∏ —Ç—ë–º–Ω–æ–π —Ç–µ–º—ã.</li>
                    <li>–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ HUD-–º–µ–Ω—é.</li>
                    <li>–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∫–Ω–æ–ø–æ–∫.</li>
                    <li>–ü—Ä–µ–ª–æ–∞–¥–µ—Ä —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º –≤ —Å—Ç–∏–ª–µ –∏–≥—Ä—ã.</li>
                    <li>–ö–∞—Å—Ç–æ–º–Ω—ã–π –∫—É—Ä—Å–æ—Ä –≤ –≤–∏–¥–µ –ø—Ä–∏—Ü–µ–ª–∞.</li>
                    <li>–ì–∞–ª–µ—Ä–µ—è –æ–±–æ–µ–≤ –∏ –∞—Ä—Ç–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.</li>
                    <li>–ú–∏–Ω–∏-—á–∞—Ç –¥–ª—è –∫–æ–º–∞–Ω–¥—ã.</li>
                    <li>–°–µ–∫—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ —Å–æ—Ü—Å–µ—Ç–µ–π –∫–ª–∞–Ω–∞.</li>
                    <li>–§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –¥–ª—è –∏–¥–µ–π –∏ –∏–≤–µ–Ω—Ç–æ–≤.</li>
                    <li>–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—É—Ä–Ω–∏—Ä–æ–≤: —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, —Å–µ—Ç–∫–∞, –ø–æ–±–µ–¥–∏—Ç–µ–ª–∏.</li>
                </ol>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="settings" class="tab-content">
            <h2><i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            
            <div class="cards-grid">
                <div class="card">
                    <div class="card-header">
                        <h3>–ó–≤—É–∫ –∏ –º—É–∑—ã–∫–∞</h3>
                    </div>
                    <div class="card-body">
                        <div style="margin-bottom: 20px;">
                            <label style="display: flex; justify-content: space-between; margin: 10px 0;">
                                <span>–ú—É–∑—ã–∫–∞</span>
                                <input type="checkbox" id="music-toggle" checked>
                            </label>
                            <label style="display: flex; justify-content: space-between; margin: 10px 0;">
                                <span>–ó–≤—É–∫–∏</span>
                                <input type="checkbox" id="sound-toggle" checked>
                            </label>
                            <label style="display: flex; justify-content: space-between; margin: 10px 0;">
                                <span>–í–∏–±—Ä–∞—Ü–∏—è</span>
                                <input type="checkbox" id="vibration-toggle" checked>
                            </label>
                            <label style="display: flex; justify-content: space-between; margin: 10px 0;">
                                <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                                <input type="checkbox" id="notifications-toggle" checked>
                            </label>
                            <button class="btn btn-secondary" onclick="requestPushNotifications()" style="width: 100%; margin-top: 10px;">
                                <i class="fas fa-bell"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                            </button>
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings()">
                            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è</h3>
                    </div>
                    <div class="card-body">
                        <div style="margin-bottom: 20px;">
                            <input type="text" id="player-name" class="form-control" placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º" value="–ò–≥—Ä–æ–∫">
                            <input type="text" id="player-id" class="form-control" placeholder="–ò–≥—Ä–æ–≤–æ–π ID" value="123456" readonly>
                            <select id="player-title" class="form-control" style="margin-top: 10px;">
                                <option value="–Ω–æ–≤–∏—á–æ–∫">–ù–æ–≤–∏—á–æ–∫</option>
                                <option value="–∏–≥—Ä–æ–∫">–ò–≥—Ä–æ–∫</option>
                                <option value="–≤–µ—Ç–µ—Ä–∞–Ω">–í–µ—Ç–µ—Ä–∞–Ω</option>
                                <option value="–ª–µ–≥–µ–Ω–¥–∞">–õ–µ–≥–µ–Ω–¥–∞</option>
                            </select>
                        </div>
                        <button class="btn btn-secondary" onclick="changeName()">
                            <i class="fas fa-edit"></i> –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫
                        </button>
                        <button class="btn btn-secondary" onclick="changeIdWithAd()" style="margin-top: 10px;">
                            <i class="fas fa-sync-alt"></i> –ò–∑–º–µ–Ω–∏—Ç—å ID
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>PWA –∏ –û—Ñ–ª–∞–π–Ω</h3>
                    </div>
                    <div class="card-body">
                        <div style="margin-bottom: 20px;">
                            <p id="pwa-status">–ü—Ä–æ–≤–µ—Ä–∫–∞ PWA...</p>
                            <p id="offline-status">–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞...</p>
                            <p id="storage-status">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞: ...</p>
                        </div>
                        <button class="btn btn-success" onclick="checkPWA()" style="width: 100%; margin-bottom: 10px;">
                            <i class="fas fa-mobile-alt"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PWA
                        </button>
                        <button class="btn btn-info" onclick="clearCache()" style="width: 100%; margin-bottom: 10px;">
                            <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
                        </button>
                        <button class="btn btn-danger" onclick="exportSave()" style="width: 100%; margin-bottom: 10px;">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                        </button>
                        <button class="btn btn-danger" onclick="resetProgress()" style="width: 100%;">
                            <i class="fas fa-trash"></i> –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
                        </button>
                        <p style="margin-top: 20px; color: #aaa; font-size: 14px;">
                            <i class="fas fa-info-circle"></i> –í–µ—Ä—Å–∏—è 4.0.0
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ PWA -->
            <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin-top: 20px;">
                <h3>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h3>
                <p>–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–≥—Ä—ã –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω:</p>
                <ul style="margin: 10px 0 20px 20px;">
                    <li><strong>Android Chrome:</strong> –ù–∞–∂–º–∏—Ç–µ ‚ãÆ ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"</li>
                    <li><strong>iOS Safari:</strong> –ù–∞–∂–º–∏—Ç–µ ‚éä ‚Üí "–ù–∞ —ç–∫—Ä–∞–Ω ¬´–î–æ–º–æ–π¬ª"</li>
                    <li><strong>Desktop:</strong> –ù–∞–∂–º–∏—Ç–µ ‚éä –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ ‚Üí "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"</li>
                </ul>
                <button class="btn btn-primary" onclick="showInstallInstructions()">
                    <i class="fas fa-question-circle"></i> –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ê–¥–º–∏–Ω –∫–Ω–æ–ø–∫–∞ -->
    <button class="admin-btn" onclick="openAdminPanel()">
        <i class="fas fa-crown"></i>
    </button>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞ -->
    <div class="modal" id="promo-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-ticket-alt"></i> –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞</h2>
                <button class="close-modal" onclick="closeModal('promo-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="promo-input" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥">
                <div id="promo-result" style="margin-top: 20px;"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" onclick="usePromoCode()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn btn-danger" onclick="closeModal('promo-modal')">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ -->
    <div class="modal" id="item-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="item-modal-title">–ü—Ä–µ–¥–º–µ—Ç</h2>
                <button class="close-modal" onclick="closeModal('item-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 30px;">
                    <div id="item-modal-icon" style="min-height: 150px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;"></div>
                    <h3 id="item-modal-name"></h3>
                    <div id="item-modal-rarity" style="margin: 10px 0;"></div>
                    <div id="item-modal-price"></div>
                    <div id="item-modal-stats" style="margin-top: 15px;"></div>
                </div>
                <div id="item-modal-actions">
                    <!-- –î–µ–π—Å—Ç–≤–∏—è —Å –ø—Ä–µ–¥–º–µ—Ç–æ–º -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞ -->
    <div class="modal" id="case-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞</h2>
                <button class="close-modal" onclick="closeModal('case-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="case-opening-area">
                    <div id="case-spinner" style="font-size: 52px; margin-bottom: 8px; animation: spin 1s linear infinite;">
                        <i class="fas fa-cog"></i>
                    </div>
                    <h3 id="case-text">–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–µ–π—Å...</h3>
                    <div class="case-reel" id="case-reel">
                        <div class="case-pointer"></div>
                        <div class="case-track" id="case-track"></div>
                    </div>
                    <div id="case-result" style="margin-top: 24px;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–¥–º–∏–Ω–∞ -->
    <div class="modal" id="admin-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-crown"></i> –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
                <button class="close-modal" onclick="closeModal('admin-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h3>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</h3>
                        <select id="admin-type" class="form-control">
                            <option value="gold">–ì–æ–ª–¥–∞</option>
                            <option value="silver">–°–µ—Ä–µ–±—Ä–æ</option>
                            <option value="crystal">–ö—Ä–∏—Å—Ç–∞–ª–ª—ã</option>
                            <option value="skin">–°–∫–∏–Ω</option>
                            <option value="knife">–ù–æ–∂</option>
                            <option value="gloves">–ü–µ—Ä—á–∞—Ç–∫–∏</option>
                            <option value="charm">–ë—Ä–µ–ª–æ–∫</option>
                            <option value="sticker">–ù–∞–∫–ª–µ–π–∫–∞</option>
                            <option value="id">–ò–≥—Ä–æ–≤–æ–π ID</option>
                        </select>
                        <input type="text" id="admin-value" class="form-control" placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ">
                        <input type="text" id="admin-code" class="form-control" placeholder="–ö–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞">
                        <button class="btn btn-success" onclick="createPromoCode()" style="width: 100%; margin-top: 10px;">
                            –°–æ–∑–¥–∞—Ç—å
                        </button>
                    </div>
                    
                    <div>
                        <h3>–í—ã–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã</h3>
                        <input type="text" id="admin-item" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞">
                        <input type="number" id="admin-amount" class="form-control" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" value="1">
                        <button class="btn btn-primary" onclick="giveItem()" style="width: 100%; margin-top: 10px;">
                            –í—ã–¥–∞—Ç—å
                        </button>
                        
                        <h3 style="margin-top: 20px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
                        <input type="text" id="ban-ip" class="form-control" placeholder="IP –¥–ª—è –±–∞–Ω–∞">
                        <input type="text" id="ban-device" class="form-control" placeholder="ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞">
                        <button class="btn btn-danger" onclick="banPlayer()" style="width: 100%; margin-top: 10px;">
                            <i class="fas fa-ban"></i> –ó–∞–±–∞–Ω–∏—Ç—å –ø–æ IP/—É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
                        </button>
                        <div id="ban-list" style="margin-top: 10px; font-size: 14px;"></div>
                    </div>
                </div>
                
                <div id="admin-message" style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px;"></div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞–Ω–∞ -->
    <div class="modal" id="create-clan-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-users"></i> –°–æ–∑–¥–∞—Ç—å –∫–ª–∞–Ω</h2>
                <button class="close-modal" onclick="closeModal('create-clan-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="new-clan-name" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞">
                <input type="text" id="new-clan-tag" class="form-control" placeholder="–¢–µ–≥ –∫–ª–∞–Ω–∞">
                <input type="text" id="new-clan-description" class="form-control" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞–Ω–∞">
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" onclick="createClan()">–°–æ–∑–¥–∞—Ç—å</button>
                <button class="btn btn-danger" onclick="closeModal('create-clan-modal')">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –∫–ª–∞–Ω -->
    <div class="modal" id="join-clan-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-sign-in-alt"></i> –í—Å—Ç—É–ø–∏—Ç—å –≤ –∫–ª–∞–Ω</h2>
                <button class="close-modal" onclick="closeModal('join-clan-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="join-clan-name" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞">
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="joinClan()">–í—Å—Ç—É–ø–∏—Ç—å</button>
                <button class="btn btn-danger" onclick="closeModal('join-clan-modal')">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫—Ä–∞—Ñ—Ç–∞ -->
    <div class="modal" id="crafting-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-hammer"></i> –ö—Ä–∞—Ñ—Ç–∏–Ω–≥</h2>
                <button class="close-modal" onclick="closeModal('crafting-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="crafting-content">
                    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫—Ä–∞—Ñ—Ç–∞ -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫–∏–Ω–∞ -->
    <div class="modal" id="upload-skin-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫–∏–Ω</h2>
                <button class="close-modal" onclick="closeModal('upload-skin-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∫–∏–Ω–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 256x256px)</p>
                </div>
                
                <input type="text" id="skin-name-input" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∫–∏–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: AK-47 | –î—Ä–∞–∫–æ–Ω)">
                
                <select id="skin-type-select" class="form-control">
                    <option value="weapon">–û—Ä—É–∂–∏–µ</option>
                    <option value="knife">–ù–æ–∂</option>
                    <option value="gloves">–ü–µ—Ä—á–∞—Ç–∫–∏</option>
                    <option value="charm">–ë—Ä–µ–ª–æ–∫</option>
                    <option value="sticker">–ù–∞–∫–ª–µ–π–∫–∞</option>
                </select>
                
                <select id="skin-rarity-select" class="form-control">
                    <option value="common">–û–±—ã—á–Ω—ã–π</option>
                    <option value="uncommon">–ù–µ–æ–±—ã—á–Ω—ã–π</option>
                    <option value="rare">–†–µ–¥–∫–∏–π</option>
                    <option value="epic">–≠–ø–∏—á–µ—Å–∫–∏–π</option>
                    <option value="legendary">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π</option>
                </select>
                
                <input type="file" id="skin-file-input" class="form-control" accept=".png,.jpg,.jpeg" style="margin: 10px 0;">
                
                <div id="skin-preview" style="margin: 20px 0; text-align: center; min-height: 100px; border: 2px dashed rgba(255,255,255,0.2); border-radius: 8px; padding: 20px;">
                    <p>–ü—Ä–µ–≤—å—é –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</p>
                </div>
                
                <div id="upload-skin-result" style="margin-top: 20px;"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" onclick="uploadSkin()">
                    <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫–∏–Ω
                </button>
                <button class="btn btn-danger" onclick="closeModal('upload-skin-modal')">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    
    <!-- AR —Ä–µ–∂–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="ar-container" id="ar-container" style="display: none;">
        <div id="ar-viewer"></div>
        <div class="ar-controls">
            <button class="ar-btn" onclick="rotateARSkin('left')">
                <i class="fas fa-rotate-left"></i>
            </button>
            <button class="ar-btn" onclick="takeARScreenshot()">
                <i class="fas fa-camera"></i>
            </button>
            <button class="ar-btn" onclick="rotateARSkin('right')">
                <i class="fas fa-rotate-right"></i>
            </button>
            <button class="ar-btn" onclick="exitARMode()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
    
    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <audio id="click-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3"></audio>
    <audio id="case-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3"></audio>
    <audio id="success-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    <audio id="error-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
    <audio id="duel-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-game-ball-tap-2073.mp3"></audio>
    <audio id="music" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-game-level-music-689.mp3" type="audio/mpeg">
    </audio>

    <script>
        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        let gameState = {
            gold: 5000,
            silver: 12500,
            crystals: 50, // –ù–æ–≤–∞—è –≤–∞–ª—é—Ç–∞
            level: 15,
            exp: 1250,
            expToNext: 2000,
            inventory: [],
            dailyStreak: 0,
            lastDaily: null,
            clicks: { gold: 0, silver: 0 },
            earned: { gold: 0, silver: 0 },
            settings: {
                music: true,
                sound: true,
                vibration: true,
                notifications: true
            },
            stats: { itemsSold: 0, casesOpened: 0 },
            promoCodes: {},
            customSkins: [],
            achievements: [],
            bots: { novice: 0, pro: 0, mafia: 0 },
            lastPlayTime: Date.now(),
            clan: null,
            duels: { wins: 0, losses: 0, history: [] },
            auctionItems: [],
            playerTitle: "–Ω–æ–≤–∏—á–æ–∫",
            profile: {
                name: "–ò–≥—Ä–æ–∫",
                id: "123456",
                avatar: "default-1",
                customAvatar: null
            },
            battlePass: {
                level: 1,
                exp: 0,
                expToNext: 100,
                premium: false,
                claimed: [],
                questsClaimed: []
            },
            trades: [],
            bans: { ips: [], devices: [] }
        };

        let allItems = [];
        let marketItems = [];
        let cases = [];
        let dailyRewards = [];
        let selectedItems = [];
        let skinImages = {};
        let achievementsList = [];
        let collections = [];
        let eventsList = [];
        let gamesList = [];
        let battlePassRewards = [];
        let marketPage = 1;
        let caseOpeningInProgress = false;
        const marketPerPage = 6;
        let duelActive = false;
        let duelTimeLeft = 10;
        let duelInterval;
        let player1Clicks = 0;
        let player2Clicks = 0;
        let currentDuelBet = 0;
        let isDuelStarted = false;
        let deferredPrompt = null;
        const defaultAvatars = [
            { id: "default-1", label: "üòé" },
            { id: "default-2", label: "ü¶ä" },
            { id: "default-3", label: "üê∫" },
            { id: "default-4", label: "üêâ" },
            { id: "default-5", label: "üî•" },
            { id: "default-6", label: "‚ö°" },
            { id: "default-7", label: "üéØ" },
            { id: "default-8", label: "üõ°Ô∏è" }
        ];
        const clanDirectory = [
            { name: "Night Wolves", members: 24, level: 3 },
            { name: "ST2 Legends", members: 35, level: 5 },
            { name: "Silver Foxes", members: 18, level: 2 }
        ];
        
        // ==================== PWA –§–£–ù–ö–¶–ò–ò ====================
        function createInlineManifest() {
            const iconSvg = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="512" height="512">
                  <rect width="512" height="512" rx="96" fill="#1a237e"/>
                  <text x="50%" y="56%" font-size="256" text-anchor="middle" dominant-baseline="middle">üî´</text>
                </svg>
            `.trim();
            const iconUrl = `data:image/svg+xml,${encodeURIComponent(iconSvg)}`;
            const manifest = {
                name: "Standoff 2 - Offline",
                short_name: "Standoff2",
                start_url: "./stanok.html",
                scope: "./",
                display: "standalone",
                background_color: "#0a0a1a",
                theme_color: "#1a237e",
                description: "Standoff 2 —Å –æ–Ω–ª–∞–π–Ω-—Ä—ã–Ω–∫–æ–º, –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–º, –∫–µ–π—Å–∞–º–∏ –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ —Å–∫–∏–Ω–∞–º–∏",
                icons: [
                    { src: iconUrl, sizes: "192x192", type: "image/svg+xml" },
                    { src: iconUrl, sizes: "512x512", type: "image/svg+xml" }
                ]
            };
            const blob = new Blob([JSON.stringify(manifest)], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            let link = document.querySelector('link[rel="manifest"]');
            if (!link) {
                link = document.createElement('link');
                link.rel = 'manifest';
                document.head.appendChild(link);
            }
            link.href = url;
        }

        function registerInlineServiceWorker() {
            if (!('serviceWorker' in navigator)) return;
            const swCode = `
                const CACHE_NAME = 'standoff2-offline-v2';
                const ASSETS = [
                  './',
                  './stanok.html'
                ];

                self.addEventListener('install', (event) => {
                  event.waitUntil(
                    caches.open(CACHE_NAME)
                      .then((cache) => cache.addAll(ASSETS))
                      .then(() => self.skipWaiting())
                  );
                });

                self.addEventListener('activate', (event) => {
                  event.waitUntil(
                    caches.keys()
                      .then((keys) => Promise.all(
                        keys.filter((key) => key !== CACHE_NAME).map((key) => caches.delete(key))
                      ))
                      .then(() => self.clients.claim())
                  );
                });

                self.addEventListener('fetch', (event) => {
                  if (event.request.method !== 'GET') {
                    return;
                  }

                  if (event.request.mode === 'navigate') {
                    event.respondWith(
                      fetch(event.request)
                        .then((response) => {
                          const copy = response.clone();
                          caches.open(CACHE_NAME).then((cache) => cache.put(event.request, copy));
                          return response;
                        })
                        .catch(() => caches.match('./stanok.html'))
                    );
                    return;
                  }

                  event.respondWith(
                    caches.match(event.request)
                      .then((cached) => cached || fetch(event.request).then((response) => {
                        if (response.ok && new URL(event.request.url).origin === self.location.origin) {
                          const copy = response.clone();
                          caches.open(CACHE_NAME).then((cache) => cache.put(event.request, copy));
                        }
                        return response;
                      }))
                  );
                });
            `.trim();
            const blob = new Blob([swCode], { type: 'text/javascript' });
            const swUrl = URL.createObjectURL(blob);
            navigator.serviceWorker.register(swUrl).catch(console.error);
        }

        function initPWA() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ PWA
            createInlineManifest();
            registerInlineServiceWorker();
            
            // –ë–∞–Ω–Ω–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PWA
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                setTimeout(() => {
                    showInstallBanner();
                }, 5000);
            });
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('PWA —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
                document.getElementById('ar-btn').style.display = 'flex';
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞
            window.addEventListener('online', () => {
                showNotification('–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ', 'success');
            });
            
            window.addEventListener('offline', () => {
                showNotification('–†–∞–±–æ—Ç–∞–µ–º –≤ –æ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ', 'warning');
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
            updatePWAStatus();
        }
        
        function showInstallBanner() {
            if (deferredPrompt && !localStorage.getItem('pwaDismissed')) {
                document.getElementById('pwaInstallBanner').classList.add('show');
            }
        }
        
        function closeInstallBanner() {
            document.getElementById('pwaInstallBanner').classList.remove('show');
            localStorage.setItem('pwaDismissed', 'true');
        }
        
        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        showNotification('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!', 'success');
                    }
                    deferredPrompt = null;
                });
            }
            closeInstallBanner();
        }
        
        function updatePWAStatus() {
            const status = document.getElementById('pwa-status');
            const offline = document.getElementById('offline-status');
            const storage = document.getElementById('storage-status');
            
            if (navigator.onLine) {
                offline.textContent = '–°—Ç–∞—Ç—É—Å: –æ–Ω–ª–∞–π–Ω';
            } else {
                offline.textContent = '–°—Ç–∞—Ç—É—Å: –æ—Ñ–ª–∞–π–Ω';
            }
            
            if ('serviceWorker' in navigator) {
                status.textContent = 'PWA: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è';
            } else {
                status.textContent = 'PWA: –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è';
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
            if ('storage' in navigator && 'estimate' in navigator.storage) {
                navigator.storage.estimate().then(estimate => {
                    const used = (estimate.usage / 1024 / 1024).toFixed(2);
                    const total = (estimate.quota / 1024 / 1024).toFixed(2);
                    storage.textContent = `–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞: ${used}MB / ${total}MB`;
                });
            }
        }
        
        function checkPWA() {
            updatePWAStatus();
            showNotification('–°—Ç–∞—Ç—É—Å PWA –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
        }
        
        function clearCache() {
            if ('caches' in window) {
                caches.keys().then(cacheNames => {
                    cacheNames.forEach(cacheName => {
                        caches.delete(cacheName);
                    });
                });
            }
            localStorage.removeItem('standoff2_save');
            showNotification('–ö—ç—à –æ—á–∏—â–µ–Ω', 'success');
            location.reload();
        }
        
        // ==================== –û–°–ù–û–í–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        document.addEventListener('DOMContentLoaded', function() {
            // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            setTimeout(() => {
                document.getElementById('pwaLoading').classList.add('hidden');
            }, 1000);
            
            initPWA();
            initGame();
            createBackgroundAnimation();
            loadGameData();
            renderAll();
            updateUI();
            syncAudioButtons();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –º—É–∑—ã–∫—É
            if (gameState.settings.music) {
                document.getElementById('music').volume = 0.3;
                document.getElementById('music').play().catch(e => console.log("–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ"));
            }
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchTab(this.getAttribute('data-tab'));
                });
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(saveGameData, 30000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            setInterval(updateOfflineEarnings, 60000);
            
            // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–≥–æ —Å–∫–∏–Ω–∞
            document.getElementById('skin-file-input').addEventListener('change', function(e) {
                previewSkin(e.target.files[0]);
            });

            // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞
            const avatarInput = document.getElementById('avatar-file-input');
            if (avatarInput) {
                avatarInput.addEventListener('change', function(e) {
                    handleAvatarUpload(e.target.files[0]);
                });
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥–∞
            updateOfflineEarnings();
        });

        function initGame() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É —Å–∫–∏–Ω–æ–≤
            skinImages = {
                'AK-47 | –ö—Ä–∞—Å–Ω—ã–π': 'https://i.imgur.com/V1G0p0x.png',
                'AK-47 | –û–≥–Ω–µ–Ω–Ω—ã–π': 'https://i.imgur.com/V1G0p0x.png',
                'AWP | –î—Ä–∞–∫–æ–Ω': 'https://i.imgur.com/V1G0p0x.png',
                '–ù–æ–∂ –ë–∞–±–æ—á–∫–∞': 'https://i.imgur.com/V1G0p0x.png',
                '–ù–æ–∂ –ö–µ—Ä–∞–º–±–∏—Ç': 'https://i.imgur.com/V1G0p0x.png',
                'M4A4 | –°–∏–Ω–∏–π': 'https://i.imgur.com/V1G0p0x.png',
                'USP-S | –ó–æ–ª–æ—Ç–æ–π': 'https://i.imgur.com/V1G0p0x.png',
                '–ü–µ—Ä—á–∞—Ç–∫–∏ –ö–æ–∂–∞–Ω—ã–µ': 'https://i.imgur.com/V1G0p0x.png',
                '–ü–µ—Ä—á–∞—Ç–∫–∏ –ö—Ä–∞—Å–Ω—ã–µ': 'https://i.imgur.com/V1G0p0x.png',
                '–ß–∞—Ä–º –°–µ—Ä–¥—Ü–µ': 'https://i.imgur.com/V1G0p0x.png',
                '–ù–∞–∫–ª–µ–π–∫–∞ –î—Ä–∞–∫–æ–Ω': 'https://i.imgur.com/V1G0p0x.png',
                'AWP | –ù–µ–æ–Ω–æ–≤—ã–π': 'https://i.imgur.com/V1G0p0x.png'
            };

            // –°–æ–∑–¥–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            allItems = [
                { 
                    id: 1, 
                    name: "AK-47 | –ö—Ä–∞—Å–Ω—ã–π", 
                    type: "weapon", 
                    rarity: "rare", 
                    emoji: "üî´", 
                    price: 5000, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { damage: 35, accuracy: 78, fireRate: 600 }
                },
                { 
                    id: 2, 
                    name: "AWP | –î—Ä–∞–∫–æ–Ω", 
                    type: "weapon", 
                    rarity: "legendary", 
                    emoji: "üéØ", 
                    price: 50000, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { damage: 115, accuracy: 90, fireRate: 41 }
                },
                { 
                    id: 3, 
                    name: "–ù–æ–∂ –ë–∞–±–æ—á–∫–∞", 
                    type: "knife", 
                    rarity: "epic", 
                    emoji: "üî™", 
                    price: 25000, 
                    canSell: false, 
                    canCraft: true,
                    hasImage: true,
                    stats: { damage: 75, speed: 1.2 }
                },
                { 
                    id: 4, 
                    name: "–ü–µ—Ä—á–∞—Ç–∫–∏ –ö–æ–∂–∞–Ω—ã–µ", 
                    type: "gloves", 
                    rarity: "rare", 
                    emoji: "üëä", 
                    price: 15000, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { armor: 10, grip: 85 }
                },
                { 
                    id: 5, 
                    name: "–ß–∞—Ä–º –°–µ—Ä–¥—Ü–µ", 
                    type: "charm", 
                    rarity: "common", 
                    emoji: "üíñ", 
                    price: 1000, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { luck: 5 }
                },
                { 
                    id: 6, 
                    name: "–ù–∞–∫–ª–µ–π–∫–∞ –î—Ä–∞–∫–æ–Ω", 
                    type: "sticker", 
                    rarity: "common", 
                    emoji: "üêâ", 
                    price: 500, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { style: 10 }
                },
                { 
                    id: 7, 
                    name: "M4A4 | –°–∏–Ω–∏–π", 
                    type: "weapon", 
                    rarity: "uncommon", 
                    emoji: "üî´", 
                    price: 2500, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { damage: 33, accuracy: 77, fireRate: 666 }
                },
                { 
                    id: 8, 
                    name: "USP-S | –ó–æ–ª–æ—Ç–æ–π", 
                    type: "weapon", 
                    rarity: "legendary", 
                    emoji: "üî´", 
                    price: 75000, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { damage: 35, accuracy: 86, fireRate: 352 }
                },
                { 
                    id: 9, 
                    name: "–ù–æ–∂ –ö–µ—Ä–∞–º–±–∏—Ç", 
                    type: "knife", 
                    rarity: "legendary", 
                    emoji: "üó°Ô∏è", 
                    price: 95000, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { damage: 85, speed: 1.35 }
                },
                { 
                    id: 10, 
                    name: "–ü–µ—Ä—á–∞—Ç–∫–∏ –¢–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ", 
                    type: "gloves", 
                    rarity: "epic", 
                    emoji: "üß§", 
                    price: 30000, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { armor: 15, grip: 90 }
                },
                { 
                    id: 11, 
                    name: "–ß–∞—Ä–º –õ–µ–∑–≤–∏–µ", 
                    type: "charm", 
                    rarity: "uncommon", 
                    emoji: "‚ú®", 
                    price: 2500, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { luck: 8 }
                },
                { 
                    id: 12, 
                    name: "–ù–∞–∫–ª–µ–π–∫–∞ –§–µ–Ω–∏–∫—Å", 
                    type: "sticker", 
                    rarity: "rare", 
                    emoji: "üî•", 
                    price: 3500, 
                    canSell: true, 
                    canCraft: true,
                    hasImage: true,
                    stats: { style: 20 }
                }
            ];

            // –ù–∞—á–∞–ª—å–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            gameState.inventory = [
                createInventoryItem(allItems[0], { canSell: true, canCraft: true, source: 'starter' }),
                createInventoryItem(allItems[2], { canSell: true, canCraft: true, source: 'starter' }),
                createInventoryItem(allItems[4], { canSell: true, canCraft: true, source: 'starter' }),
                createInventoryItem(allItems[6], { canSell: true, canCraft: true, source: 'starter' })
            ];

            // –†—ã–Ω–æ–∫
            marketItems = [
                { 
                    id: 101, 
                    name: "AK-47 | –û–≥–Ω–µ–Ω–Ω—ã–π", 
                    type: "weapon", 
                    rarity: "epic", 
                    emoji: "üî•", 
                    price: 35000, 
                    seller: "–ò–≥—Ä–æ–∫_456",
                    hasImage: true,
                    stats: { damage: 36, accuracy: 80, fireRate: 600 }
                },
                { 
                    id: 102, 
                    name: "–ù–æ–∂ –ö–µ—Ä–∞–º–±–∏—Ç", 
                    type: "knife", 
                    rarity: "legendary", 
                    emoji: "üî™", 
                    price: 85000, 
                    seller: "–ò–≥—Ä–æ–∫_789",
                    hasImage: true,
                    stats: { damage: 80, speed: 1.4 }
                },
                { 
                    id: 103, 
                    name: "–ü–µ—Ä—á–∞—Ç–∫–∏ –ö—Ä–∞—Å–Ω—ã–µ", 
                    type: "gloves", 
                    rarity: "rare", 
                    emoji: "üß§", 
                    price: 18000, 
                    seller: "–ò–≥—Ä–æ–∫_123",
                    hasImage: true,
                    stats: { armor: 12, grip: 82 }
                },
                { 
                    id: 104, 
                    name: "AWP | –ù–µ–æ–Ω–æ–≤—ã–π", 
                    type: "weapon", 
                    rarity: "epic", 
                    emoji: "üéØ", 
                    price: 45000, 
                    seller: "–ò–≥—Ä–æ–∫_321",
                    hasImage: true,
                    stats: { damage: 110, accuracy: 88, fireRate: 41 }
                }
            ];

            // –ö–µ–π—Å—ã
            cases = [
                { id: 1, name: "–û–±—ã—á–Ω—ã–π –∫–µ–π—Å", emoji: "üì¶", priceGold: 100, priceSilver: 1000, rarity: "common" },
                { id: 2, name: "–†–µ–¥–∫–∏–π –∫–µ–π—Å", emoji: "üéÅ", priceGold: 500, priceSilver: 5000, rarity: "rare" },
                { id: 3, name: "–ü—Ä–µ–º–∏—É–º –∫–µ–π—Å", emoji: "üíé", priceGold: 2000, priceSilver: 20000, rarity: "legendary" },
                { id: 4, name: "–ë–æ–∫—Å —Å–ø–µ—Ü–æ–ø–µ—Ä–∞—Ü–∏–∏", emoji: "üß∞", priceGold: 750, priceSilver: 7500, rarity: "epic" },
                { id: 5, name: "–ë–æ–∫—Å –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–∞", emoji: "üéí", priceGold: 1200, priceSilver: 12000, rarity: "rare" }
            ];

            collections = [
                {
                    id: 1,
                    name: "–ö–æ–ª–ª–µ–∫—Ü–∏—è –û–≥–Ω—è",
                    bonus: "–ë–æ–Ω—É—Å: +50 –≥–æ–ª–¥—ã –∑–∞ –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä",
                    items: ["AK-47 | –û–≥–Ω–µ–Ω–Ω—ã–π", "–ù–∞–∫–ª–µ–π–∫–∞ –§–µ–Ω–∏–∫—Å", "–ß–∞—Ä–º –õ–µ–∑–≤–∏–µ"]
                },
                {
                    id: 2,
                    name: "–ö–æ–ª–ª–µ–∫—Ü–∏—è –î—Ä–∞–∫–æ–Ω–∞",
                    bonus: "–ë–æ–Ω—É—Å: +1 —Ä–µ–¥–∫–∏–π –∫–µ–π—Å",
                    items: ["AWP | –î—Ä–∞–∫–æ–Ω", "–ù–∞–∫–ª–µ–π–∫–∞ –î—Ä–∞–∫–æ–Ω", "–ù–æ–∂ –ë–∞–±–æ—á–∫–∞"]
                }
            ];

            eventsList = [
                { id: 1, title: "–¢—É—Ä–Ω–∏—Ä –Ω–æ–≤–∏—á–∫–æ–≤", date: "–°–µ–≥–æ–¥–Ω—è", reward: "500 —Å–µ—Ä–µ–±—Ä–∞", status: "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞" },
                { id: 2, title: "–°–æ–±—ã—Ç–∏–µ '–û—Ö–æ—Ç–∞ –Ω–∞ —Å–∫–∏–Ω—ã'", date: "–ó–∞–≤—Ç—Ä–∞", reward: "–†–µ–¥–∫–∏–π –∫–µ–π—Å", status: "–°–∫–æ—Ä–æ" }
            ];

            gamesList = [
                { id: 1, mode: "–ö–æ–º–∞–Ω–¥–Ω—ã–π –±–æ–π", players: "5v5", reward: "150 —Å–µ—Ä–µ–±—Ä–∞" },
                { id: 2, mode: "–°–Ω–∞–π–ø–µ—Ä—Å–∫–∏–π –±–æ–π", players: "3v3", reward: "100 —Å–µ—Ä–µ–±—Ä–∞" },
                { id: 3, mode: "–ó–∞–∫–ª–∞–¥–∫–∞ –±–æ–º–±—ã", players: "5v5", reward: "200 —Å–µ—Ä–µ–±—Ä–∞" }
            ];

            battlePassRewards = [
                { level: 1, free: "100 —Å–µ—Ä–µ–±—Ä–∞", premium: "–°—Ç–∏–∫–µ—Ä –§–µ–Ω–∏–∫—Å" },
                { level: 2, free: "50 –≥–æ–ª–¥—ã", premium: "–ë—Ä–µ–ª–æ–∫ –õ–µ–∑–≤–∏–µ" },
                { level: 3, free: "–û–±—ã—á–Ω—ã–π –∫–µ–π—Å", premium: "–†–µ–¥–∫–∏–π –∫–µ–π—Å" },
                { level: 4, free: "150 —Å–µ—Ä–µ–±—Ä–∞", premium: "–ù–æ–∂ –ë–∞–±–æ—á–∫–∞" }
            ];

            // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã
            dailyRewards = [
                { day: 1, reward: "100 —Å–µ—Ä–µ–±—Ä–∞", emoji: "ü•à", type: "silver", value: 100 },
                { day: 2, reward: "50 –≥–æ–ª–¥—ã", emoji: "ü•á", type: "gold", value: 50 },
                { day: 3, reward: "–û–±—ã—á–Ω—ã–π –∫–µ–π—Å", emoji: "üì¶", type: "case", value: "common" },
                { day: 4, reward: "200 —Å–µ—Ä–µ–±—Ä–∞", emoji: "ü•à", type: "silver", value: 200 },
                { day: 5, reward: "–†–µ–¥–∫–∏–π —Å–∫–∏–Ω", emoji: "üî´", type: "skin", value: "rare" },
                { day: 6, reward: "100 –≥–æ–ª–¥—ã", emoji: "ü•á", type: "gold", value: 100 },
                { day: 7, reward: "–ü—Ä–µ–º–∏—É–º –∫–µ–π—Å", emoji: "üíé", type: "case", value: "premium" }
            ];

            // –ü—Ä–æ–º–æ–∫–æ–¥—ã
            gameState.promoCodes = {
                'WELCOME': { type: 'gold', value: 1000, used: false },
                'FIRSTSKIN': { type: 'skin', value: 'AK-47 | –ö—Ä–∞—Å–Ω—ã–π', used: false },
                'STANDOFF': { type: 'silver', value: 5000, used: false },
                'NEWSKIN': { type: 'skin', value: 'AWP | –î—Ä–∞–∫–æ–Ω', used: false },
                'PVPMASTER': { type: 'crystal', value: 10, used: false },
                'NEWID': { type: 'id', value: '777777', used: false },
                'FREEKNIFE': { type: 'knife', value: '–ù–æ–∂ –ö–µ—Ä–∞–º–±–∏—Ç', used: false }
            };
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            initAchievements();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–∫–∏–Ω—ã
            if (gameState.customSkins.length > 0) {
                gameState.customSkins.forEach(skin => {
                    skinImages[skin.name] = skin.imageData;
                    allItems.push({
                        id: Date.now() + Math.random(),
                        name: skin.name,
                        type: skin.type,
                        rarity: skin.rarity,
                        emoji: getEmojiForType(skin.type),
                        price: skin.price || 1000,
                        canSell: true,
                        canCraft: true,
                        hasImage: true,
                        isCustom: true,
                        stats: skin.stats || { special: "–ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫–∏–Ω" }
                    });
                });
            }
        }
        
        function initAchievements() {
            achievementsList = [
                {
                    id: 1,
                    name: "–ü–µ—Ä–≤–∞—è –∫—Ä–æ–≤—å",
                    description: "–ö—É–ø–∏—Ç—å –ø–µ—Ä–≤—ã–π —Å–∫–∏–Ω",
                    icon: "ü©∏",
                    points: 10,
                    progress: 0,
                    maxProgress: 1,
                    completed: false,
                    secret: false,
                    reward: { type: "gold", value: 500 }
                },
                {
                    id: 2,
                    name: "–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä",
                    description: "–°–æ–±—Ä–∞—Ç—å 10 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤",
                    icon: "üìö",
                    points: 25,
                    progress: 0,
                    maxProgress: 10,
                    completed: false,
                    secret: false,
                    reward: { type: "crystal", value: 5 }
                },
                {
                    id: 3,
                    name: "–¢–æ—Ä–≥–æ–≤–µ—Ü",
                    description: "–ü—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –Ω–∞ 100,000 —Å–µ—Ä–µ–±—Ä–∞",
                    icon: "üí∞",
                    points: 50,
                    progress: 0,
                    maxProgress: 100000,
                    completed: false,
                    secret: false,
                    reward: { type: "silver", value: 10000 }
                },
                {
                    id: 4,
                    name: "–ú–∞—Å—Ç–µ—Ä –∫–µ–π—Å–æ–≤",
                    description: "–û—Ç–∫—Ä—ã—Ç—å 50 –∫–µ–π—Å–æ–≤",
                    icon: "üéÅ",
                    points: 75,
                    progress: 0,
                    maxProgress: 50,
                    completed: false,
                    secret: false,
                    reward: { type: "skin", value: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∫–µ–π—Å" }
                },
                {
                    id: 5,
                    name: "–ö–ª–∏–∫–µ—Ä-–º–∞—à–∏–Ω–∞",
                    description: "–°–¥–µ–ª–∞—Ç—å 10,000 –∫–ª–∏–∫–æ–≤",
                    icon: "üñ±Ô∏è",
                    points: 100,
                    progress: 0,
                    maxProgress: 10000,
                    completed: false,
                    secret: false,
                    reward: { type: "gold", value: 2000 }
                },
                {
                    id: 6,
                    name: "–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –¥—É—ç–ª–µ–π",
                    description: "–í—ã–∏–≥—Ä–∞—Ç—å 10 PvP –¥—É—ç–ª–µ–π",
                    icon: "‚öîÔ∏è",
                    points: 150,
                    progress: 0,
                    maxProgress: 10,
                    completed: false,
                    secret: false,
                    reward: { type: "crystal", value: 25 }
                },
                {
                    id: 7,
                    name: "–ë–æ—Ç-—Ñ–µ—Ä–º–µ—Ä",
                    description: "–ö—É–ø–∏—Ç—å 10 –±–æ—Ç–æ–≤",
                    icon: "ü§ñ",
                    points: 50,
                    progress: 0,
                    maxProgress: 10,
                    completed: false,
                    secret: true,
                    reward: { type: "silver", value: 5000 }
                },
                {
                    id: 8,
                    name: "–°–æ–∑–¥–∞—Ç–µ–ª—å",
                    description: "–ó–∞–≥—Ä—É–∑–∏—Ç—å 5 –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–∫–∏–Ω–æ–≤",
                    icon: "üé®",
                    points: 100,
                    progress: 0,
                    maxProgress: 5,
                    completed: false,
                    secret: false,
                    reward: { type: "crystal", value: 15 }
                }
            ];
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
            if (gameState.achievements.length > 0) {
                achievementsList.forEach(ach => {
                    const saved = gameState.achievements.find(a => a.id === ach.id);
                    if (saved) {
                        ach.progress = saved.progress;
                        ach.completed = saved.completed;
                    }
                });
            } else {
                gameState.achievements = achievementsList.map(a => ({
                    id: a.id,
                    progress: a.progress,
                    completed: a.completed
                }));
            }
            
            updateAchievementsProgress();
        }

        // ==================== –†–ï–ù–î–ï–†–ò–ù–ì ====================
        function renderAll() {
            renderInventory();
            renderMarket();
            renderCases();
            renderCollections();
            renderDailyRewards();
            renderBattlePass();
            renderSkins();
            renderAchievements();
            renderDuels();
            renderTrades();
            renderClans();
            renderGames();
            renderEvents();
            renderAuction();
            renderProfile();
            updateOfflineEarningsDisplay();
        }

        function renderInventory() {
            const container = document.getElementById('inventory-items');
            if (!container) return;
            
            container.innerHTML = '';
            
            const activeFilter = document.querySelector('.btn.active');
            const filter = activeFilter && activeFilter.id ? activeFilter.id.replace('filter-', '') : 'all';
            
            let itemsToShow = gameState.inventory;
            if (filter !== 'all') {
                itemsToShow = gameState.inventory.filter(item => item.type === filter);
            }
            
            if (itemsToShow.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #aaa;"><i class="fas fa-box-open" style="font-size: 48px;"></i><h3>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</h3></div>';
                return;
            }
            
            itemsToShow.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card item-card';
                card.innerHTML = `
                    <div class="item-rarity rarity-${item.rarity}">${getRarityName(item.rarity)}</div>
                    <div class="item-image">
                        ${getItemImageHTML(item)}
                    </div>
                    <div class="item-name">${item.name} ${item.isCustom ? '<i class="fas fa-user" style="color: var(--secondary); margin-left: 5px;"></i>' : ''}</div>
                    <div class="item-actions">
                        <button class="item-action" onclick="viewItem(${item.id})">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="item-action" onclick="sellItem(${item.id})" ${!item.canSell ? 'disabled' : ''}>
                            <i class="fas fa-coins"></i>
                        </button>
                        <button class="item-action" onclick="selectForCraft(${item.id})" ${!item.canCraft ? 'disabled' : ''}>
                            <i class="fas fa-hammer"></i>
                        </button>
                        <button class="item-action" onclick="auctionItem(${item.id})" ${!item.canSell ? 'disabled' : ''}>
                            <i class="fas fa-gavel"></i>
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderMarket() {
            const container = document.getElementById('market-items');
            if (!container) return;
            
            container.innerHTML = '';
            
            const marketSearchInput = document.getElementById('market-search');
            const search = marketSearchInput ? marketSearchInput.value.toLowerCase() : '';
            let itemsToShow = marketItems;
            
            if (search) {
                itemsToShow = marketItems.filter(item => 
                    item.name.toLowerCase().includes(search) ||
                    item.type.toLowerCase().includes(search)
                );
            }
            const totalPages = Math.max(1, Math.ceil(itemsToShow.length / marketPerPage));
            marketPage = Math.min(Math.max(marketPage, 1), totalPages);
            const start = (marketPage - 1) * marketPerPage;
            const pagedItems = itemsToShow.slice(start, start + marketPerPage);

            if (pagedItems.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #aaa;"><i class="fas fa-store-slash" style="font-size: 48px;"></i><h3>–¢–æ–≤–∞—Ä–æ–≤ –Ω–µ—Ç</h3></div>';
            }
            
            pagedItems.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card item-card';
                card.innerHTML = `
                    <div class="item-rarity rarity-${item.rarity}">${getRarityName(item.rarity)}</div>
                    <div class="item-image">
                        ${getItemImageHTML(item)}
                    </div>
                    <div class="item-name">${item.name}</div>
                    <div class="card-body">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>–ü—Ä–æ–¥–∞–≤–µ—Ü:</span>
                            <span>${item.seller}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                            <span>–¶–µ–Ω–∞:</span>
                            <span>${item.price} —Å–µ—Ä–µ–±—Ä–∞</span>
                        </div>
                        <button class="btn btn-primary" style="width: 100%;" onclick="buyItem(${item.id})">
                            <i class="fas fa-shopping-cart"></i> –ö—É–ø–∏—Ç—å
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });

            const pageInfo = document.getElementById('market-page-info');
            if (pageInfo) {
                pageInfo.textContent = `–°—Ç—Ä–∞–Ω–∏—Ü–∞ ${marketPage} –∏–∑ ${totalPages}`;
            }
        }

        function renderCases() {
            const container = document.getElementById('cases-grid');
            if (!container) return;
            
            container.innerHTML = '';
            
            cases.forEach(caseItem => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${caseItem.name}</h3>
                    </div>
                    <div class="card-body">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <div style="font-size: 64px;">${caseItem.emoji}</div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between;">
                                <span>–¶–µ–Ω–∞:</span>
                                <div>
                                    <div><i class="fas fa-coins" style="color: var(--gold);"></i> ${caseItem.priceGold} –≥–æ–ª–¥—ã</div>
                                    <div><i class="fas fa-coins" style="color: var(--silver);"></i> ${caseItem.priceSilver} —Å–µ—Ä–µ–±—Ä–∞</div>
                                </div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-silver" style="flex: 1;" onclick="openCase(${caseItem.id}, 'silver')">
                                <i class="fas fa-coins"></i> –°–µ—Ä–µ–±—Ä–æ
                            </button>
                            <button class="btn btn-gold" style="flex: 1;" onclick="openCase(${caseItem.id}, 'gold')">
                                <i class="fas fa-coins"></i> –ì–æ–ª–¥–∞
                            </button>
                        </div>
                        <button class="btn btn-secondary" style="width: 100%; margin-top: 10px;" onclick="showCaseOdds(${caseItem.id})">
                            <i class="fas fa-chart-pie"></i> –®–∞–Ω—Å—ã
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderCollections() {
            const container = document.getElementById('collections-grid');
            if (!container) return;

            container.innerHTML = '';

            collections.forEach(collection => {
                const ownedCount = collection.items.filter(itemName =>
                    gameState.inventory.some(inv => inv.name === itemName)
                ).length;
                const progressPercent = Math.round((ownedCount / collection.items.length) * 100);
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${collection.name}</h3>
                    </div>
                    <div class="card-body">
                        <p>${collection.bonus}</p>
                        <div class="progress-bar" style="margin: 10px 0;">
                            <div class="progress-fill" style="width: ${progressPercent}%"></div>
                        </div>
                        <p>${ownedCount}/${collection.items.length} –ø—Ä–µ–¥–º–µ—Ç–æ–≤</p>
                        <ul style="margin-top: 10px;">
                            ${collection.items.map(item => `<li>${item}</li>`).join('')}
                        </ul>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderDailyRewards() {
            const container = document.getElementById('daily-rewards');
            if (!container) return;
            
            container.innerHTML = '';
            
            dailyRewards.forEach((reward, index) => {
                const claimed = gameState.dailyStreak > index;
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>–î–µ–Ω—å ${reward.day}</h3>
                    </div>
                    <div class="card-body" style="text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 15px;">${reward.emoji}</div>
                        <h4>${reward.reward}</h4>
                        <div style="margin-top: 15px;">
                            ${claimed ? 
                                '<span style="color: var(--success);"><i class="fas fa-check-circle"></i> –ü–æ–ª—É—á–µ–Ω–æ</span>' : 
                                '<span style="color: #aaa;"><i class="fas fa-lock"></i> –î–æ—Å—Ç—É–ø–Ω–æ</span>'
                            }
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
            
            // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
            renderDailyQuests();
        }
        
        function renderDailyQuests() {
            const container = document.getElementById('daily-quests');
            if (!container) return;
            
            const quests = [
                { id: 1, name: "–ö–ª–∏–∫–∞–π –∫–∞–∫ –ø—Ä–æ–∫–ª—è—Ç—ã–π", description: "–°–¥–µ–ª–∞—Ç—å 100 –∫–ª–∏–∫–æ–≤", progress: gameState.clicks.gold + gameState.clicks.silver, max: 100, reward: "100 —Å–µ—Ä–µ–±—Ä–∞", type: "click" },
                { id: 2, name: "–¢–æ—Ä–≥–æ–≤—ã–π –¥–µ–Ω—å", description: "–ü—Ä–æ–¥–∞—Ç—å 3 –ø—Ä–µ–¥–º–µ—Ç–∞", progress: 0, max: 3, reward: "50 –≥–æ–ª–¥—ã", type: "sell" },
                { id: 3, name: "–£–¥–∞—á–ª–∏–≤—ã–π", description: "–û—Ç–∫—Ä—ã—Ç—å 1 –∫–µ–π—Å", progress: 0, max: 1, reward: "–†–µ–¥–∫–∏–π –∫–µ–π—Å", type: "case" }
            ];
            
            container.innerHTML = '';
            
            quests.forEach(quest => {
                const progressPercent = Math.min((quest.progress / quest.max) * 100, 100);
                const isCompleted = quest.progress >= quest.max;
                
                const questDiv = document.createElement('div');
                questDiv.className = 'quest-card';
                questDiv.innerHTML = `
                    <div>
                        <h4>${quest.name}</h4>
                        <p>${quest.description}</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progressPercent}%"></div>
                        </div>
                        <p>${quest.progress}/${quest.max}</p>
                    </div>
                    <div>
                        <div class="quest-reward">${quest.reward}</div>
                        <button class="btn ${isCompleted ? 'btn-success' : 'btn-secondary'}" onclick="claimQuest(${quest.id})" ${!isCompleted ? 'disabled' : ''}>
                            ${isCompleted ? '<i class="fas fa-gift"></i> –ü–æ–ª—É—á–∏—Ç—å' : '–ù–µ –≥–æ—Ç–æ–≤–æ'}
                        </button>
                    </div>
                `;
                container.appendChild(questDiv);
            });
        }

        function renderBattlePass() {
            const questsContainer = document.getElementById('battlepass-quests');
            const rewardsContainer = document.getElementById('battlepass-rewards');
            if (!questsContainer || !rewardsContainer) return;

            const quests = [
                { id: 1, name: "–û—Ç–∫—Ä—ã—Ç—å 2 –∫–µ–π—Å–∞", progress: (gameState.stats && gameState.stats.casesOpened) || 0, max: 2, exp: 40 },
                { id: 2, name: "–°–¥–µ–ª–∞—Ç—å 50 –∫–ª–∏–∫–æ–≤", progress: gameState.clicks.gold + gameState.clicks.silver, max: 50, exp: 30 },
                { id: 3, name: "–ü—Ä–æ–¥–∞—Ç—å 2 –ø—Ä–µ–¥–º–µ—Ç–∞", progress: (gameState.stats && gameState.stats.itemsSold) || 0, max: 2, exp: 30 }
            ];

            questsContainer.innerHTML = '';
            quests.forEach(quest => {
                const progressPercent = Math.min((quest.progress / quest.max) * 100, 100);
                const alreadyClaimed = gameState.battlePass.questsClaimed.includes(quest.id);
                const canClaim = quest.progress >= quest.max && !alreadyClaimed;
                const questDiv = document.createElement('div');
                questDiv.className = 'quest-card';
                questDiv.innerHTML = `
                    <div>
                        <h4>${quest.name}</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progressPercent}%"></div>
                        </div>
                        <p>${quest.progress}/${quest.max}</p>
                    </div>
                    <div>
                        <div class="quest-reward">+${quest.exp} –æ–ø—ã—Ç–∞</div>
                        <button class="btn ${canClaim ? 'btn-success' : 'btn-secondary'}" onclick="claimBattlePassQuest(${quest.id}, ${quest.exp})" ${!canClaim ? 'disabled' : ''}>
                            ${alreadyClaimed ? '–ó–∞–±—Ä–∞–Ω–æ' : (canClaim ? '–ü–æ–ª—É—á–∏—Ç—å' : '–ù–µ –≥–æ—Ç–æ–≤–æ')}
                        </button>
                    </div>
                `;
                questsContainer.appendChild(questDiv);
            });

            rewardsContainer.innerHTML = '';
            battlePassRewards.forEach(reward => {
                const isLocked = gameState.battlePass.level < reward.level;
                const isClaimed = gameState.battlePass.claimed.includes(reward.level);
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>–£—Ä–æ–≤–µ–Ω—å ${reward.level}</h3>
                    </div>
                    <div class="card-body" style="text-align: center;">
                        <p>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ: ${reward.free}</p>
                        <p>–ü—Ä–µ–º–∏—É–º: ${reward.premium}</p>
                        <button class="btn ${isLocked || isClaimed ? 'btn-secondary' : 'btn-success'}" onclick="claimBattlePassReward(${reward.level})" ${isLocked || isClaimed ? 'disabled' : ''}>
                            ${isClaimed ? '–ó–∞–±—Ä–∞–Ω–æ' : (isLocked ? '–ó–∞–∫—Ä—ã—Ç–æ' : '–ó–∞–±—Ä–∞—Ç—å')}
                        </button>
                    </div>
                `;
                rewardsContainer.appendChild(card);
            });

            document.getElementById('battlepass-level').textContent = gameState.battlePass.level;
            const progressPercent = Math.min((gameState.battlePass.exp / gameState.battlePass.expToNext) * 100, 100);
            document.getElementById('battlepass-progress').style.width = `${progressPercent}%`;
            document.getElementById('battlepass-premium-btn').innerHTML = gameState.battlePass.premium
                ? '<i class="fas fa-star"></i> –ü—Ä–µ–º–∏—É–º –∞–∫—Ç–∏–≤–µ–Ω'
                : '<i class="fas fa-star"></i> –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–º–∏—É–º';
        }

        function renderTrades() {
            const select = document.getElementById('trade-item-select');
            const list = document.getElementById('trade-list');
            if (!select || !list) return;

            if (gameState.inventory.length === 0) {
                select.innerHTML = '<option value="">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</option>';
            } else {
                select.innerHTML = gameState.inventory.map(item => `<option value="${item.id}">${item.name}</option>`).join('');
            }
            list.innerHTML = '';

            if (gameState.trades.length === 0) {
                list.innerHTML = '<p style="color: #aaa;">–û–±–º–µ–Ω–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>';
                return;
            }

            gameState.trades.forEach(trade => {
                const tradeDiv = document.createElement('div');
                tradeDiv.className = 'trade-card';
                tradeDiv.innerHTML = `
                    <h4>${trade.item.name}</h4>
                    <p>–•–æ—á—É: ${getTypeName(trade.want)}</p>
                    <p style="color: #aaa;">${trade.note || '–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è'}</p>
                    <button class="btn btn-success" onclick="acceptTrade(${trade.id})">
                        <i class="fas fa-handshake"></i> –ü—Ä–∏–Ω—è—Ç—å –æ–±–º–µ–Ω
                    </button>
                `;
                list.appendChild(tradeDiv);
            });
        }

        function renderGames() {
            const container = document.getElementById('games-grid');
            if (!container) return;

            container.innerHTML = '';
            gamesList.forEach(game => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${game.mode}</h3>
                    </div>
                    <div class="card-body" style="text-align: center;">
                        <p>–†–µ–∂–∏–º: ${game.players}</p>
                        <p>–ù–∞–≥—Ä–∞–¥–∞: ${game.reward}</p>
                        <button class="btn btn-primary" onclick="startGame(${game.id})">
                            <i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –º–∞—Ç—á
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderEvents() {
            const container = document.getElementById('events-grid');
            if (!container) return;

            container.innerHTML = '';
            eventsList.forEach(eventItem => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${eventItem.title}</h3>
                    </div>
                    <div class="card-body">
                        <p>–î–∞—Ç–∞: ${eventItem.date}</p>
                        <p>–ù–∞–≥—Ä–∞–¥–∞: ${eventItem.reward}</p>
                        <p style="color: var(--secondary);">${eventItem.status}</p>
                        <button class="btn btn-secondary" onclick="joinEvent(${eventItem.id})">
                            <i class="fas fa-ticket-alt"></i> –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderProfile() {
            const nameInput = document.getElementById('profile-name');
            const idInput = document.getElementById('profile-id');
            const avatarDisplay = document.getElementById('profile-avatar-display');
            const avatarGrid = document.getElementById('avatar-grid');

            if (nameInput) nameInput.value = gameState.profile.name;
            if (idInput) idInput.value = gameState.profile.id;
            const settingsName = document.getElementById('player-name');
            const settingsId = document.getElementById('player-id');
            if (settingsName) settingsName.value = gameState.profile.name;
            if (settingsId) settingsId.value = gameState.profile.id;

            if (avatarDisplay) {
                if (gameState.profile.customAvatar) {
                    avatarDisplay.innerHTML = `<img src="${gameState.profile.customAvatar}" alt="avatar" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">`;
                } else {
                    const avatar = defaultAvatars.find(a => a.id === gameState.profile.avatar);
                    avatarDisplay.textContent = avatar ? avatar.label : "üéØ";
                }
            }

            if (avatarGrid) {
                avatarGrid.innerHTML = '';
                defaultAvatars.forEach(avatar => {
                    const button = document.createElement('div');
                    button.className = `avatar-option ${gameState.profile.avatar === avatar.id ? 'active' : ''}`;
                    button.innerHTML = `<div style="font-size: 28px;">${avatar.label}</div>`;
                    button.onclick = () => selectAvatar(avatar.id);
                    avatarGrid.appendChild(button);
                });
            }

            const levelProgress = document.getElementById('level-progress');
            if (levelProgress) {
                const percent = Math.min((gameState.exp / gameState.expToNext) * 100, 100);
                levelProgress.style.width = `${percent}%`;
            }
            const levelEl = document.getElementById('profile-level');
            const expEl = document.getElementById('profile-exp');
            const expNextEl = document.getElementById('profile-exp-next');
            if (levelEl) levelEl.textContent = gameState.level;
            if (expEl) expEl.textContent = gameState.exp;
            if (expNextEl) expNextEl.textContent = gameState.expToNext;
        }

        function renderSkins() {
            const container = document.getElementById('skins-grid');
            if (!container) return;
            
            container.innerHTML = '';
            
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Å–∫–∏–Ω—ã
            const allSkins = [
                ...allItems.filter(item => item.hasImage),
                ...marketItems.filter(item => item.hasImage)
            ];
            
            const activeSkinFilter = document.querySelector('.btn.active');
            const filter = activeSkinFilter && activeSkinFilter.id ? activeSkinFilter.id.replace('skin-filter-', '') : 'all';
            const skinSearchInput = document.getElementById('skin-search');
            const search = skinSearchInput ? skinSearchInput.value.toLowerCase() : '';
            
            let skinsToShow = allSkins;
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
            if (filter === 'custom') {
                skinsToShow = allSkins.filter(skin => skin.isCustom);
            } else if (filter === 'default') {
                skinsToShow = allSkins.filter(skin => !skin.isCustom);
            } else if (filter === 'animated') {
                skinsToShow = allSkins.filter(skin => skin.animated);
            } else if (filter === 'limited') {
                skinsToShow = allSkins.filter(skin => skin.limited);
            }
            
            // –ü–æ–∏—Å–∫
            if (search) {
                skinsToShow = skinsToShow.filter(skin => 
                    skin.name.toLowerCase().includes(search)
                );
            }
            
            if (skinsToShow.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #aaa;"><i class="fas fa-images" style="font-size: 48px;"></i><h3>–°–∫–∏–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3></div>';
                return;
            }
            
            // –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
            const uniqueSkins = [];
            const seenNames = new Set();
            
            skinsToShow.forEach(skin => {
                if (!seenNames.has(skin.name)) {
                    seenNames.add(skin.name);
                    uniqueSkins.push(skin);
                }
            });
            
            uniqueSkins.forEach(skin => {
                const card = document.createElement('div');
                card.className = 'card item-card';
                card.innerHTML = `
                    <div class="item-rarity rarity-${skin.rarity}">${getRarityName(skin.rarity)}</div>
                    <div class="item-image">
                        ${getItemImageHTML(skin)}
                    </div>
                    <div class="item-name">${skin.name} ${skin.isCustom ? '<i class="fas fa-user" style="color: var(--secondary); margin-left: 5px;"></i>' : ''}</div>
                    <div class="card-body">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                            <span>–¢–∏–ø:</span>
                            <span>${getTypeName(skin.type)}</span>
                        </div>
                        <button class="btn btn-primary" style="width: 100%;" onclick="viewSkin('${skin.name}')">
                            <i class="fas fa-eye"></i> –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å
                        </button>
                        <button class="btn btn-secondary" style="width: 100%; margin-top: 5px;" onclick="preview3D('${skin.name}')">
                            <i class="fas fa-cube"></i> 3D –ü—Ä–æ—Å–º–æ—Ç—Ä
                        </button>
                        ${skin.isCustom ? `
                        <button class="btn btn-danger" style="width: 100%; margin-top: 5px;" onclick="deleteCustomSkin('${skin.name}')">
                            <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                        </button>
                        ` : ''}
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        function renderAchievements() {
            const container = document.getElementById('achievements-list');
            if (!container) return;
            
            const activeAchievementFilter = document.querySelector('.btn.active');
            const filter = activeAchievementFilter && activeAchievementFilter.id ? activeAchievementFilter.id.replace('achievement-filter-', '') : 'all';
            const achievementSearchInput = document.getElementById('achievement-search');
            const search = achievementSearchInput ? achievementSearchInput.value.toLowerCase() : '';
            
            container.innerHTML = '';
            
            let achievementsToShow = achievementsList;
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
            if (filter === 'completed') {
                achievementsToShow = achievementsList.filter(a => a.completed);
            } else if (filter === 'in-progress') {
                achievementsToShow = achievementsList.filter(a => !a.completed && a.progress > 0);
            } else if (filter === 'secret') {
                achievementsToShow = achievementsList.filter(a => a.secret);
            }
            
            // –ü–æ–∏—Å–∫
            if (search) {
                achievementsToShow = achievementsToShow.filter(a => 
                    a.name.toLowerCase().includes(search) ||
                    a.description.toLowerCase().includes(search)
                );
            }
            
            if (achievementsToShow.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #aaa;"><i class="fas fa-trophy" style="font-size: 48px;"></i><h3>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3></div>';
                return;
            }
            
            achievementsToShow.forEach(achievement => {
                const progressPercent = Math.min((achievement.progress / achievement.maxProgress) * 100, 100);
                
                const achievementDiv = document.createElement('div');
                achievementDiv.className = 'achievement-card';
                achievementDiv.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div style="flex: 1;">
                        <h4>${achievement.name} ${achievement.secret ? 'üîí' : ''}</h4>
                        <p>${achievement.description}</p>
                        <div class="achievement-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                            <p>${achievement.progress}/${achievement.maxProgress}</p>
                        </div>
                        <p>–ù–∞–≥—Ä–∞–¥–∞: ${achievement.reward.value} ${getRewardTypeName(achievement.reward.type)}</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: var(--gold);">${achievement.points}</div>
                        <p>–æ—á–∫–æ–≤</p>
                        ${achievement.completed ? 
                            '<span style="color: var(--success);"><i class="fas fa-check-circle"></i> –ó–∞–≤–µ—Ä—à–µ–Ω–æ</span>' :
                            '<button class="btn btn-success" onclick="claimAchievement(' + achievement.id + ')" ' + (achievement.progress >= achievement.maxProgress ? '' : 'disabled') + '>–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É</button>'
                        }
                    </div>
                `;
                container.appendChild(achievementDiv);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            updateAchievementStats();
        }
        
        function renderDuels() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –¥—É—ç–ª–µ–π
            const historyContainer = document.getElementById('duel-history');
            if (historyContainer) {
                historyContainer.innerHTML = '';
                
                if (gameState.duels.history.length === 0) {
                    historyContainer.innerHTML = '<p style="color: #aaa; text-align: center;">–ò—Å—Ç–æ—Ä–∏—è –¥—É—ç–ª–µ–π –ø—É—Å—Ç–∞</p>';
                } else {
                    gameState.duels.history.slice(-5).reverse().forEach(duel => {
                        const duelDiv = document.createElement('div');
                        duelDiv.className = 'quest-card';
                        duelDiv.innerHTML = `
                            <div>
                                <h4>${duel.won ? 'üèÜ –ü–æ–±–µ–¥–∞' : 'üíÄ –ü–æ—Ä–∞–∂–µ–Ω–∏–µ'}</h4>
                                <p>–°—á–µ—Ç: ${duel.player1Score} - ${duel.player2Score}</p>
                                <p>–°—Ç–∞–≤–∫–∞: ${duel.bet} —Å–µ—Ä–µ–±—Ä–∞</p>
                            </div>
                            <div>
                                <p>${new Date(duel.date).toLocaleDateString()}</p>
                                <p style="color: ${duel.won ? 'var(--success)' : 'var(--danger)'}">
                                    ${duel.won ? '+' + duel.bet : '-' + duel.bet} —Å–µ—Ä–µ–±—Ä–∞
                                </p>
                            </div>
                        `;
                        historyContainer.appendChild(duelDiv);
                    });
                }
            }
        }
        
        function renderClans() {
            const hasClan = gameState.clan !== null;
            
            document.getElementById('current-clan').style.display = hasClan ? 'block' : 'none';
            document.getElementById('no-clan').style.display = hasClan ? 'none' : 'block';
            
            if (hasClan) {
                document.getElementById('clan-name').textContent = gameState.clan.name;
                document.getElementById('clan-level').textContent = gameState.clan.level;
                document.getElementById('clan-members').textContent = `${gameState.clan.members.length}/50`;
                document.getElementById('clan-points').textContent = gameState.clan.points;
                const membersList = document.getElementById('clan-members-list');
                if (membersList) {
                    membersList.innerHTML = gameState.clan.members.map(member => `<div>${member}</div>`).join('');
                }
                const tagInput = document.getElementById('clan-tag');
                const descInput = document.getElementById('clan-description');
                const privacySelect = document.getElementById('clan-privacy');
                if (tagInput) tagInput.value = gameState.clan.tag || '';
                if (descInput) descInput.value = gameState.clan.description || '';
                if (privacySelect) privacySelect.value = gameState.clan.privacy || 'open';
            }
        }

        function createClan() {
            const name = document.getElementById('new-clan-name').value.trim();
            if (!name) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞!', 'error');
                return;
            }
            gameState.clan = {
                name,
                tag: document.getElementById('new-clan-tag').value.trim(),
                description: document.getElementById('new-clan-description').value.trim(),
                privacy: 'open',
                level: 1,
                members: ["–í—ã"],
                points: 0
            };
            closeModal('create-clan-modal');
            renderClans();
            saveGameData();
            showNotification(`–ö–ª–∞–Ω ${name} —Å–æ–∑–¥–∞–Ω!`, 'success');
        }

        function joinClan() {
            const name = document.getElementById('join-clan-name').value.trim();
            if (!name) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞!', 'error');
                return;
            }
            gameState.clan = {
                name,
                tag: 'ST2',
                description: '–ö–ª–∞–Ω –∏–∑ –ø–æ–∏—Å–∫–∞',
                privacy: 'open',
                level: 2,
                members: ["–í—ã", "–ò–≥—Ä–æ–∫_01", "–ò–≥—Ä–æ–∫_02"],
                points: 350
            };
            closeModal('join-clan-modal');
            renderClans();
            saveGameData();
            showNotification(`–í—ã –≤—Å—Ç—É–ø–∏–ª–∏ –≤ –∫–ª–∞–Ω ${name}!`, 'success');
        }

        function saveClanSettings() {
            if (!gameState.clan) return;
            gameState.clan.tag = document.getElementById('clan-tag').value.trim();
            gameState.clan.description = document.getElementById('clan-description').value.trim();
            gameState.clan.privacy = document.getElementById('clan-privacy').value;
            saveGameData();
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∞–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
        }

        function searchClans() {
            const query = document.getElementById('clan-search').value.toLowerCase();
            const results = document.getElementById('clan-search-results');
            if (!results) return;

            const matches = clanDirectory.filter(clan => clan.name.toLowerCase().includes(query));
            if (matches.length === 0) {
                results.innerHTML = '<p style="color: #aaa;">–ö–ª–∞–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>';
                return;
            }
            results.innerHTML = matches.map(clan => `
                <div style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; margin-bottom: 8px;">
                    <strong>${clan.name}</strong> ‚Ä¢ –£—Ä–æ–≤–µ–Ω—å ${clan.level} ‚Ä¢ ${clan.members} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
                </div>
            `).join('');
        }
        
        function renderAuction() {
            const activeContainer = document.getElementById('active-auctions');
            const completedContainer = document.getElementById('completed-auctions');
            
            if (activeContainer) {
                activeContainer.innerHTML = '';
                
                if (gameState.auctionItems.length === 0) {
                    activeContainer.innerHTML = '<p style="color: #aaa; text-align: center;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞—É–∫—Ü–∏–æ–Ω–æ–≤</p>';
                } else {
                    gameState.auctionItems.forEach(item => {
                        const timeLeft = Math.max(0, item.endTime - Date.now());
                        const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                        
                        const auctionDiv = document.createElement('div');
                        auctionDiv.className = 'card';
                        auctionDiv.innerHTML = `
                            <div class="card-header">
                                <h4>${item.name}</h4>
                            </div>
                            <div class="card-body">
                                <div class="item-image">
                                    ${getItemImageHTML(item)}
                                </div>
                                <div style="margin: 15px 0;">
                                    <p>–¢–µ–∫—É—â–∞—è —Å—Ç–∞–≤–∫–∞: <strong>${item.currentBid || item.startPrice} —Å–µ—Ä–µ–±—Ä–∞</strong></p>
                                    <p>–í–ª–∞–¥–µ–ª–µ—Ü: ${item.owner}</p>
                                    <div class="auction-timer">${hours}—á ${minutes}–º</div>
                                </div>
                                <div class="bid-input">
                                    <input type="number" id="bid-${item.id}" class="form-control" placeholder="–í–∞—à–∞ —Å—Ç–∞–≤–∫–∞" value="${(item.currentBid || item.startPrice) + 100}">
                                    <button class="btn btn-primary" onclick="placeBid(${item.id})">
                                        <i class="fas fa-gavel"></i> –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É
                                    </button>
                                </div>
                            </div>
                        `;
                        activeContainer.appendChild(auctionDiv);
                    });
                }
            }
        }

        // ==================== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        function createInventoryItem(item, overrides = {}) {
            return {
                ...item,
                id: Date.now() + Math.floor(Math.random() * 1000),
                canSell: overrides.canSell !== undefined ? overrides.canSell : (item.canSell !== undefined ? item.canSell : true),
                canCraft: overrides.canCraft !== undefined ? overrides.canCraft : (item.canCraft !== undefined ? item.canCraft : true),
                source: overrides.source || item.source || 'default'
            };
        }

        function grantItemByType(type, value = null) {
            let item = null;
            if (value) {
                item = allItems.find(i => i.name === value);
            }
            if (!item) {
                const pool = allItems.filter(i => i.type === type);
                item = pool[Math.floor(Math.random() * pool.length)];
            }
            if (!item) {
                item = allItems[0];
            }
            const newItem = createInventoryItem(item, { canSell: true, canCraft: true, source: 'reward' });
            gameState.inventory.push(newItem);
            renderInventory();
            return newItem;
        }

        function gainExp(amount) {
            gameState.exp += amount;
            while (gameState.exp >= gameState.expToNext) {
                gameState.exp -= gameState.expToNext;
                gameState.level += 1;
                gameState.expToNext = Math.floor(gameState.expToNext * 1.25);
                grantLevelReward();
            }
            renderProfile();
            updateUI();
        }

        function grantLevelReward() {
            const pool = allItems.filter(item =>
                ['weapon', 'knife', 'gloves', 'charm', 'sticker'].includes(item.type)
            );
            const reward = pool[Math.floor(Math.random() * pool.length)];
            if (reward) {
                const newItem = createInventoryItem(reward, { canSell: true, canCraft: true, source: 'level' });
                gameState.inventory.push(newItem);
                showNotification(`–ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Ä–æ–≤–µ–Ω—å: ${newItem.name}!`, 'success');
                renderInventory();
            }
        }

        function switchTab(tabName) {
            playSound('click');
            
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const targetTab = document.getElementById(tabName);
            if (targetTab) {
                targetTab.classList.add('active');
                document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏
                if (tabName === 'skins') {
                    renderSkins();
                } else if (tabName === 'achievements') {
                    renderAchievements();
                } else if (tabName === 'duels') {
                    renderDuels();
                } else if (tabName === 'collections') {
                    renderCollections();
                } else if (tabName === 'battlepass') {
                    renderBattlePass();
                } else if (tabName === 'trades') {
                    renderTrades();
                } else if (tabName === 'clans') {
                    renderClans();
                } else if (tabName === 'games') {
                    renderGames();
                } else if (tabName === 'events') {
                    renderEvents();
                } else if (tabName === 'auction') {
                    renderAuction();
                } else if (tabName === 'profile') {
                    renderProfile();
                }
            }
        }

        function scrollTabs(offset) {
            const tabs = document.getElementById('tabs-scroll');
            if (tabs) {
                tabs.scrollBy({ left: offset, behavior: 'smooth' });
            }
        }

        function changeMarketPage(direction) {
            marketPage += direction;
            renderMarket();
        }

        function startTrade(itemId) {
            switchTab('trades');
            const select = document.getElementById('trade-item-select');
            if (select) {
                select.value = itemId;
            }
        }

        function filterInventory(filter) {
            document.querySelectorAll('#inventory .btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`filter-${filter}`).classList.add('active');
            renderInventory();
            playSound('click');
        }

        function filterSkins(filter) {
            document.querySelectorAll('#skins .btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`skin-filter-${filter}`).classList.add('active');
            renderSkins();
            playSound('click');
        }

        function filterAchievements(filter) {
            document.querySelectorAll('#achievements .btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`achievement-filter-${filter}`).classList.add('active');
            renderAchievements();
            playSound('click');
        }

        function searchSkins() {
            renderSkins();
            playSound('click');
        }
        
        function searchAchievements() {
            renderAchievements();
            playSound('click');
        }

        // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∫–∏–Ω–æ–≤ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        function viewItem(itemId) {
            const item = [...gameState.inventory, ...marketItems].find(i => i.id === itemId);
            if (!item) return;
            
            document.getElementById('item-modal-title').textContent = item.name;
            
            // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ–º HTML –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const imageHTML = getItemImageHTML(item, true);
            document.getElementById('item-modal-icon').innerHTML = imageHTML;
            
            document.getElementById('item-modal-name').textContent = item.name;
            document.getElementById('item-modal-rarity').innerHTML = `<span class="rarity-${item.rarity}">${getRarityName(item.rarity)}</span>`;
            document.getElementById('item-modal-price').textContent = `–¶–µ–Ω–∞: ${item.price || 'N/A'} —Å–µ—Ä–µ–±—Ä–∞`;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–µ–¥–º–µ—Ç–∞
            const statsHTML = item.stats ? 
                `<div style="margin-top: 15px;">
                    <h4>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</h4>
                    ${Object.entries(item.stats).map(([key, value]) => 
                        `<div style="display: flex; justify-content: space-between; margin: 5px 0;">
                            <span>${getStatName(key)}:</span>
                            <span>${value}</span>
                        </div>`
                    ).join('')}
                </div>` : '';
            document.getElementById('item-modal-stats').innerHTML = statsHTML;
            
            const actions = document.getElementById('item-modal-actions');
            actions.innerHTML = '';
            
            if (gameState.inventory.find(i => i.id === itemId)) {
                actions.innerHTML = `
                    <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" onclick="sellItem(${itemId})" ${!item.canSell ? 'disabled' : ''}>
                        <i class="fas fa-coins"></i> –ü—Ä–æ–¥–∞—Ç—å (${Math.floor(item.price * 0.7)} —Å–µ—Ä–µ–±—Ä–∞)
                    </button>
                    <button class="btn btn-secondary" style="width: 100%; margin-bottom: 10px;" onclick="addToMarket(${itemId})" ${!item.canSell ? 'disabled' : ''}>
                        <i class="fas fa-store"></i> –í—ã—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ —Ä—ã–Ω–æ–∫
                    </button>
                    <button class="btn btn-success" style="width: 100%; margin-bottom: 10px;" onclick="selectForCraft(${itemId})" ${!item.canCraft ? 'disabled' : ''}>
                        <i class="fas fa-hammer"></i> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫—Ä–∞—Ñ—Ç–µ
                    </button>
                    <button class="btn btn-info" style="width: 100%; margin-bottom: 10px;" onclick="startTrade(${itemId})">
                        <i class="fas fa-exchange-alt"></i> –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–±–º–µ–Ω
                    </button>
                    <button class="btn btn-warning" style="width: 100%; background: linear-gradient(135deg, var(--legendary), #ff5722);" onclick="auctionItem(${itemId})" ${!item.canSell ? 'disabled' : ''}>
                        <i class="fas fa-gavel"></i> –í—ã—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω
                    </button>
                `;
            } else {
                actions.innerHTML = `
                    <button class="btn btn-primary" style="width: 100%;" onclick="buyItem(${itemId})">
                        <i class="fas fa-shopping-cart"></i> –ö—É–ø–∏—Ç—å –∑–∞ ${item.price} —Å–µ—Ä–µ–±—Ä–∞
                    </button>
                `;
            }
            
            openModal('item-modal');
            playSound('click');
        }

        function viewSkin(skinName) {
            const skin = allItems.find(i => i.name === skinName) || marketItems.find(i => i.name === skinName);
            if (!skin) return;
            const inventoryItem = gameState.inventory.find(i => i.name === skinName);
            
            document.getElementById('item-modal-title').textContent = skin.name;
            
            // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ–º HTML –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const imageHTML = getItemImageHTML(skin, true);
            document.getElementById('item-modal-icon').innerHTML = imageHTML;
            
            document.getElementById('item-modal-name').textContent = skin.name;
            document.getElementById('item-modal-rarity').innerHTML = `<span class="rarity-${skin.rarity}">${getRarityName(skin.rarity)}</span>`;
            document.getElementById('item-modal-price').textContent = `–¢–∏–ø: ${getTypeName(skin.type)}`;
            
            const actions = document.getElementById('item-modal-actions');
            if (inventoryItem) {
                actions.innerHTML = `
                    <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" onclick="sellItem(${inventoryItem.id})" ${!inventoryItem.canSell ? 'disabled' : ''}>
                        <i class="fas fa-coins"></i> –ü—Ä–æ–¥–∞—Ç—å (${Math.floor(inventoryItem.price * 0.7)} —Å–µ—Ä–µ–±—Ä–∞)
                    </button>
                    <button class="btn btn-secondary" style="width: 100%; margin-bottom: 10px;" onclick="addToMarket(${inventoryItem.id})" ${!inventoryItem.canSell ? 'disabled' : ''}>
                        <i class="fas fa-store"></i> –í—ã—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ —Ä—ã–Ω–æ–∫
                    </button>
                    <button class="btn btn-success" style="width: 100%; margin-bottom: 10px;" onclick="selectForCraft(${inventoryItem.id})" ${!inventoryItem.canCraft ? 'disabled' : ''}>
                        <i class="fas fa-hammer"></i> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫—Ä–∞—Ñ—Ç–µ
                    </button>
                    <button class="btn btn-info" style="width: 100%; margin-bottom: 10px;" onclick="startTrade(${inventoryItem.id})">
                        <i class="fas fa-exchange-alt"></i> –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–±–º–µ–Ω
                    </button>
                    <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="copySkinInfo('${skin.name}')">
                        <i class="fas fa-copy"></i> –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    </button>
                    <button class="btn btn-secondary" style="width: 100%; margin-top: 10px;" onclick="preview3D('${skin.name}')">
                        <i class="fas fa-cube"></i> 3D –ü—Ä–æ—Å–º–æ—Ç—Ä
                    </button>
                `;
            } else {
                actions.innerHTML = `
                    <div style="text-align: center;">
                        <p>${skin.isCustom ? 'üé® –≠—Ç–æ –≤–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫–∏–Ω!' : '‚öôÔ∏è –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–∫–∏–Ω –∏–≥—Ä—ã'}</p>
                        <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="copySkinInfo('${skin.name}')">
                            <i class="fas fa-copy"></i> –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                        </button>
                        <button class="btn btn-secondary" style="width: 100%; margin-top: 10px;" onclick="preview3D('${skin.name}')">
                            <i class="fas fa-cube"></i> 3D –ü—Ä–æ—Å–º–æ—Ç—Ä
                        </button>
                        ${skin.isCustom ? `
                        <button class="btn btn-danger" style="width: 100%; margin-top: 10px;" onclick="deleteCustomSkin('${skin.name}')">
                            <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å —Å–∫–∏–Ω
                        </button>
                        ` : ''}
                        ${'WebXR' in window ? `
                        <button class="btn btn-success" style="width: 100%; margin-top: 10px;" onclick="startARSkin('${skin.name}')">
                            <i class="fas fa-vr-cardboard"></i> AR –ü—Ä–æ—Å–º–æ—Ç—Ä
                        </button>
                        ` : ''}
                    </div>
                `;
            }
            
            openModal('item-modal');
            playSound('click');
        }

        function sellItem(itemId) {
            const item = gameState.inventory.find(i => i.id === itemId);
            if (!item || !item.canSell) {
                showNotification('–≠—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç –Ω–µ–ª—å–∑—è –ø—Ä–æ–¥–∞—Ç—å!', 'error');
                return;
            }
            
            const price = Math.floor(item.price * 0.7);
            gameState.silver += price;
            gameState.inventory = gameState.inventory.filter(i => i.id !== itemId);
            gameState.stats.itemsSold = (gameState.stats.itemsSold || 0) + 1;
            gainExp(25);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–¢–æ—Ä–≥–æ–≤–µ—Ü"
            updateAchievementProgress(3, price);
            
            showNotification(`–ü—Ä–æ–¥–∞–Ω–æ –∑–∞ ${price} —Å–µ—Ä–µ–±—Ä–∞!`, 'success');
            updateUI();
            renderInventory();
            saveGameData();
        }

        function buyItem(itemId) {
            const item = marketItems.find(i => i.id === itemId);
            if (!item) return;
            
            if (gameState.silver < item.price) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–µ—Ä–µ–±—Ä–∞!', 'error');
                return;
            }
            
            gameState.silver -= item.price;
            const newItem = createInventoryItem(item, { canSell: true, canCraft: true, source: 'market' });
            gameState.inventory.push(newItem);
            marketItems = marketItems.filter(i => i.id !== itemId);
            gainExp(20);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä"
            updateAchievementProgress(2, 1);
            
            showNotification(`–ö—É–ø–ª–µ–Ω–æ –∑–∞ ${item.price} —Å–µ—Ä–µ–±—Ä–∞!`, 'success');
            updateUI();
            renderInventory();
            renderMarket();
            saveGameData();
        }

        function addToMarket(itemId) {
            const item = gameState.inventory.find(i => i.id === itemId);
            if (!item || !item.canSell) {
                showNotification('–≠—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç –Ω–µ–ª—å–∑—è –ø—Ä–æ–¥–∞—Ç—å!', 'error');
                return;
            }
            
            const price = prompt('–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É –≤ —Å–µ—Ä–µ–±—Ä–µ:', item.price);
            if (!price || isNaN(price)) return;
            
            const marketItem = {
                ...item,
                id: Date.now(),
                price: parseInt(price),
                seller: '–í—ã'
            };
            
            marketItems.push(marketItem);
            gameState.inventory = gameState.inventory.filter(i => i.id !== itemId);
            
            showNotification('–ü—Ä–µ–¥–º–µ—Ç –≤—ã—Å—Ç–∞–≤–ª–µ–Ω –Ω–∞ —Ä—ã–Ω–æ–∫!', 'success');
            renderInventory();
            renderMarket();
            closeModal('item-modal');
            saveGameData();
        }

        function searchMarket() {
            marketPage = 1;
            renderMarket();
            playSound('click');
        }

        function refreshMarket() {
            marketPage = 1;
            showNotification('–†—ã–Ω–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω!', 'success');
            renderMarket();
        }

        function sellAllItems() {
            if (gameState.inventory.length === 0) {
                showNotification('–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç!', 'error');
                return;
            }
            
            if (!confirm('–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã?')) return;
            
            let total = 0;
            const itemsToSell = gameState.inventory.filter(item => item.canSell);
            
            itemsToSell.forEach(item => {
                total += Math.floor(item.price * 0.7);
            });
            
            gameState.silver += total;
            gameState.inventory = gameState.inventory.filter(item => !item.canSell);
            gameState.stats.itemsSold = (gameState.stats.itemsSold || 0) + itemsToSell.length;
            gainExp(10 * itemsToSell.length);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–¢–æ—Ä–≥–æ–≤–µ—Ü"
            updateAchievementProgress(3, total);
            
            showNotification(`–ü—Ä–æ–¥–∞–Ω–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤: ${itemsToSell.length}<br>–ü–æ–ª—É—á–µ–Ω–æ: ${total} —Å–µ—Ä–µ–±—Ä–∞`, 'success');
            updateUI();
            renderInventory();
            saveGameData();
        }

        // ==================== –ö–ï–ô–°–´ ====================
        function getCaseRewardPool(caseRarity) {
            const fallbackMap = {
                common: ['common', 'uncommon'],
                rare: ['uncommon', 'rare', 'epic'],
                epic: ['rare', 'epic', 'legendary'],
                legendary: ['epic', 'legendary']
            };

            const rarities = fallbackMap[caseRarity] || ['common'];
            const pool = allItems.filter(item => rarities.includes(item.rarity));
            return pool.length ? pool : allItems;
        }

        function buildCaseReel(pool, reward) {
            const track = document.getElementById('case-track');
            if (!track) return;

            const reelItems = [];
            for (let i = 0; i < 24; i++) {
                const randomItem = pool[Math.floor(Math.random() * pool.length)] || reward;
                reelItems.push(randomItem);
            }

            reelItems[20] = reward;

            track.innerHTML = reelItems.map(item => {
                const emoji = item.emoji || 'üéØ';
                return `<div class="case-reel-item" title="${item.name}">${emoji}</div>`;
            }).join('');

            track.style.transition = 'none';
            track.style.transform = 'translateX(0px)';

            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    const slotWidth = 100;
                    const targetIndex = 20;
                    const reel = document.getElementById('case-reel');
                    const reelCenterOffset = ((reel ? reel.clientWidth : 420) / 2) - 48;
                    const targetX = -((targetIndex * slotWidth) - reelCenterOffset);
                    track.style.transition = 'transform 2.2s cubic-bezier(0.1, 0.8, 0.15, 1)';
                    track.style.transform = `translateX(${targetX}px)`;
                });
            });
        }

        // ==================== –ö–ï–ô–°–´ ====================
        function openCase(caseId, currency) {
            if (caseOpeningInProgress) {
                showNotification('–ö–µ–π—Å —É–∂–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –¥–æ–∂–¥–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞', 'warning');
                return;
            }

            const caseItem = cases.find(c => c.id === caseId);
            if (!caseItem) return;

            const price = currency === 'gold' ? caseItem.priceGold : caseItem.priceSilver;
            const playerCurrency = currency === 'gold' ? gameState.gold : gameState.silver;

            if (playerCurrency < price) {
                showNotification(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ${currency === 'gold' ? '–≥–æ–ª–¥—ã' : '—Å–µ—Ä–µ–±—Ä–∞'}!`, 'error');
                return;
            }

            const pool = getCaseRewardPool(caseItem.rarity);
            const reward = pool[Math.floor(Math.random() * pool.length)];

            if (!reward) {
                showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å: –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥', 'error');
                return;
            }

            caseOpeningInProgress = true;
            if (currency === 'gold') {
                gameState.gold -= price;
            } else {
                gameState.silver -= price;
            }
            updateUI();

            document.getElementById('case-text').textContent = '–ö–µ–π—Å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è...';
            document.getElementById('case-result').innerHTML = '';
            document.getElementById('case-spinner').style.display = 'block';
            openModal('case-modal');
            playSound('case');

            buildCaseReel(pool, reward);

            setTimeout(() => {
                document.getElementById('case-spinner').style.display = 'none';
                document.getElementById('case-text').textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!';

                const imageHTML = getItemImageHTML(reward, true);
                document.getElementById('case-result').innerHTML = `
                    <div style="min-height: 150px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                        ${imageHTML}
                    </div>
                    <h3 style="margin: 20px 0;">${reward.name}</h3>
                    <div class="rarity-${reward.rarity}" style="display: inline-block; padding: 5px 15px; border-radius: 20px;">
                        ${getRarityName(reward.rarity)}
                    </div>
                `;

                const newItem = createInventoryItem(reward, { canSell: true, canCraft: true, source: 'case' });
                gameState.inventory.push(newItem);
                gameState.stats.casesOpened = (gameState.stats.casesOpened || 0) + 1;
                gainExp(60);

                updateAchievementProgress(4, 1);
                renderInventory();
                showNotification(`–í—ã –ø–æ–ª—É—á–∏–ª–∏: ${reward.name}!`, 'success');

                caseOpeningInProgress = false;
                saveGameData();
            }, 2300);
        }

        function showCaseOdds(caseId) {
            const caseItem = cases.find(c => c.id === caseId);
            if (!caseItem) return;
            
            const odds = {
                common: { common: 70, uncommon: 25, rare: 4, epic: 1 },
                rare: { uncommon: 50, rare: 35, epic: 12, legendary: 3 },
                epic: { rare: 45, epic: 40, legendary: 15 },
                legendary: { rare: 40, epic: 35, legendary: 25 }
            };
            
            const caseOdds = odds[caseItem.rarity];
            if (!caseOdds) {
                showNotification('–®–∞–Ω—Å—ã –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ –∫–µ–π—Å–∞', 'warning');
                return;
            }
            let content = `<h3>–®–∞–Ω—Å—ã –≤—ã–ø–∞–¥–µ–Ω–∏—è:</h3><ul style="margin-top: 20px;">`;
            
            for (const [rarity, chance] of Object.entries(caseOdds)) {
                content += `<li style="margin: 10px 0;"><span class="rarity-${rarity}" style="padding: 3px 10px;">${getRarityName(rarity)}</span>: ${chance}%</li>`;
            }
            
            content += '</ul>';
            
            showNotification(content, 'info');
        }

        function exchangeGoldToSilver() {
            if (gameState.gold < 10) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥–æ–ª–¥—ã!', 'error');
                return;
            }
            gameState.gold -= 10;
            gameState.silver += 100;
            updateUI();
            saveGameData();
            showNotification('–û–±–º–µ–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω: +100 —Å–µ—Ä–µ–±—Ä–∞', 'success');
        }

        function togglePremiumPass() {
            gameState.battlePass.premium = !gameState.battlePass.premium;
            saveGameData();
            renderBattlePass();
            showNotification(gameState.battlePass.premium ? '–ü—Ä–µ–º–∏—É–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!' : '–ü—Ä–µ–º–∏—É–º –æ—Ç–∫–ª—é—á–µ–Ω', 'success');
        }

        function claimBattlePassQuest(questId, exp) {
            if (gameState.battlePass.questsClaimed.includes(questId)) return;
            gameState.battlePass.questsClaimed.push(questId);
            gainBattlePassExp(exp);
            saveGameData();
            renderBattlePass();
            showNotification(`–ü–æ–ª—É—á–µ–Ω–æ +${exp} –æ–ø—ã—Ç–∞ –±–æ–µ–≤–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∞`, 'success');
        }

        function claimBattlePassReward(level) {
            if (gameState.battlePass.claimed.includes(level)) {
                showNotification('–ù–∞–≥—Ä–∞–¥–∞ —É–∂–µ –ø–æ–ª—É—á–µ–Ω–∞!', 'warning');
                return;
            }
            if (gameState.battlePass.level < level) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–∫–∞—á–∞–π—Ç–µ —É—Ä–æ–≤–µ–Ω—å!', 'error');
                return;
            }

            const reward = battlePassRewards.find(item => item.level === level);
            if (!reward) return;

            gameState.battlePass.claimed.push(level);
            grantBattlePassReward(reward.free);

            if (gameState.battlePass.premium) {
                grantBattlePassReward(reward.premium);
            }

            saveGameData();
            renderBattlePass();
            showNotification('–ù–∞–≥—Ä–∞–¥–∞ –±–æ–µ–≤–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∞ –ø–æ–ª—É—á–µ–Ω–∞!', 'success');
        }

        function gainBattlePassExp(amount) {
            gameState.battlePass.exp += amount;
            while (gameState.battlePass.exp >= gameState.battlePass.expToNext) {
                gameState.battlePass.exp -= gameState.battlePass.expToNext;
                gameState.battlePass.level += 1;
                gameState.battlePass.expToNext = Math.floor(gameState.battlePass.expToNext * 1.2);
            }
        }

        function grantBattlePassReward(text) {
            if (text.includes('—Å–µ—Ä–µ–±—Ä–∞')) {
                const value = parseInt(text, 10) || 100;
                gameState.silver += value;
            } else if (text.includes('–≥–æ–ª–¥—ã')) {
                const value = parseInt(text, 10) || 50;
                gameState.gold += value;
            } else if (text.includes('–∫–µ–π—Å')) {
                const caseItem = cases.find(c => c.rarity === 'common') || cases[0];
                if (caseItem) {
                    gameState.inventory.push(createInventoryItem(
                        { ...caseItem, name: `${caseItem.name}`, type: 'case' },
                        { canSell: true, canCraft: false, source: 'battlepass' }
                    ));
                }
            } else if (text.includes('–°—Ç–∏–∫–µ—Ä')) {
                grantItemByType('sticker');
            } else if (text.includes('–ë—Ä–µ–ª–æ–∫')) {
                grantItemByType('charm');
            } else if (text.includes('–ù–æ–∂')) {
                grantItemByType('knife');
            }
            updateUI();
        }

        function createTrade() {
            const itemId = parseInt(document.getElementById('trade-item-select').value, 10);
            const want = document.getElementById('trade-want-select').value;
            const note = document.getElementById('trade-note').value.trim();
            const item = gameState.inventory.find(i => i.id === itemId);
            if (!item) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç –¥–ª—è –æ–±–º–µ–Ω–∞!', 'error');
                return;
            }
            gameState.inventory = gameState.inventory.filter(i => i.id !== itemId);
            gameState.trades.push({ id: Date.now(), item, want, note });
            document.getElementById('trade-note').value = '';
            renderInventory();
            renderTrades();
            saveGameData();
            showNotification('–û–±–º–µ–Ω —Å–æ–∑–¥–∞–Ω!', 'success');
        }

        function acceptTrade(tradeId) {
            const trade = gameState.trades.find(t => t.id === tradeId);
            if (!trade) return;
            const reward = grantItemByType(trade.want);
            gameState.trades = gameState.trades.filter(t => t.id !== tradeId);
            gainExp(15);
            renderTrades();
            renderInventory();
            saveGameData();
            showNotification(`–û–±–º–µ–Ω –∑–∞–≤–µ—Ä—à—ë–Ω! –ü–æ–ª—É—á–µ–Ω–æ: ${reward.name}`, 'success');
        }

        function startGame(gameId) {
            const game = gamesList.find(g => g.id === gameId);
            if (!game) return;
            showNotification(`–ü–æ–∏—Å–∫ –º–∞—Ç—á–∞: ${game.mode}...`, 'info');
            setTimeout(() => {
                gameState.silver += 100;
                gainExp(40);
                updateUI();
                saveGameData();
                showNotification(`–ú–∞—Ç—á –∑–∞–≤–µ—Ä—à—ë–Ω! –ù–∞–≥—Ä–∞–¥–∞: ${game.reward}`, 'success');
            }, 1500);
        }

        function joinEvent(eventId) {
            const eventItem = eventsList.find(e => e.id === eventId);
            if (!eventItem) return;
            showNotification(`–í—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Å–æ–±—ã—Ç–∏–∏ "${eventItem.title}"`, 'success');
        }

        // ==================== –ö–õ–ò–ö–ï–† –ò –ê–í–¢–û-–§–ï–†–ú–ê ====================
        function clickGold() {
            gameState.gold += 10;
            gameState.clicks.gold++;
            gameState.earned.gold += 10;
            gainExp(1);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–ö–ª–∏–∫–µ—Ä-–º–∞—à–∏–Ω–∞"
            updateAchievementProgress(5, 1);
            
            updateUI();
            document.getElementById('gold-clicks').textContent = gameState.clicks.gold;
            document.getElementById('total-gold').textContent = gameState.earned.gold;
            
            playSound('click');
            vibrate();
        }

        function clickSilver() {
            gameState.silver += 25;
            gameState.clicks.silver++;
            gameState.earned.silver += 25;
            gainExp(1);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–ö–ª–∏–∫–µ—Ä-–º–∞—à–∏–Ω–∞"
            updateAchievementProgress(5, 1);
            
            updateUI();
            document.getElementById('silver-clicks').textContent = gameState.clicks.silver;
            document.getElementById('total-silver').textContent = gameState.earned.silver;
            
            playSound('click');
            vibrate();
        }

        function exchangeCurrency() {
            if (gameState.silver >= 1000) {
                gameState.silver -= 1000;
                gameState.gold += 100;
                
                updateUI();
                showNotification('–û–±–º–µ–Ω —É—Å–ø–µ—à–µ–Ω!', 'success');
                saveGameData();
            } else {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–µ—Ä–µ–±—Ä–∞!', 'error');
            }
        }
        
        function buyBot(type) {
            const botPrices = {
                novice: 1000,
                pro: 5000,
                mafia: 25000
            };
            
            const botEarnings = {
                novice: 10,
                pro: 100,
                mafia: 500
            };
            
            const price = botPrices[type];
            
            if (gameState.silver < price) {
                showNotification(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–µ—Ä–µ–±—Ä–∞! –ù—É–∂–Ω–æ ${price}`, 'error');
                return;
            }
            
            gameState.silver -= price;
            gameState.bots[type]++;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–ë–æ—Ç-—Ñ–µ—Ä–º–µ—Ä"
            updateAchievementProgress(7, 1);
            
            updateUI();
            updateBotsDisplay();
            showNotification(`–ë–æ—Ç ${type} –∫—É–ø–ª–µ–Ω!`, 'success');
            saveGameData();
        }
        
        function updateBotsDisplay() {
            document.getElementById('bot-novice-count').textContent = `–ö—É–ø–ª–µ–Ω–æ: ${gameState.bots.novice}`;
            document.getElementById('bot-pro-count').textContent = `–ö—É–ø–ª–µ–Ω–æ: ${gameState.bots.pro}`;
            document.getElementById('bot-mafia-count').textContent = `–ö—É–ø–ª–µ–Ω–æ: ${gameState.bots.mafia}`;
        }
        
        function updateOfflineEarnings() {
            const now = Date.now();
            const lastPlay = gameState.lastPlayTime || now;
            const minutesPassed = Math.floor((now - lastPlay) / (1000 * 60));
            
            if (minutesPassed > 0) {
                const earnings = {
                    silver: (gameState.bots.novice * 10 + gameState.bots.pro * 100 + gameState.bots.mafia * 500) * minutesPassed
                };
                
                gameState.offlineEarnings = earnings;
                gameState.lastPlayTime = now;
                saveGameData();
            }
        }
        
        function updateOfflineEarningsDisplay() {
            const earnings = gameState.offlineEarnings || { silver: 0 };
            document.getElementById('offline-earnings').textContent = `–ù–∞–∫–æ–ø–ª–µ–Ω–æ: ${earnings.silver} —Å–µ—Ä–µ–±—Ä–∞`;
        }
        
        function claimOfflineEarnings() {
            const earnings = gameState.offlineEarnings || { silver: 0 };
            
            if (earnings.silver > 0) {
                gameState.silver += earnings.silver;
                gameState.offlineEarnings = { silver: 0 };
                
                updateUI();
                updateOfflineEarningsDisplay();
                showNotification(`–ü–æ–ª—É—á–µ–Ω–æ ${earnings.silver} —Å–µ—Ä–µ–±—Ä–∞ –∑–∞ –æ—Ñ–ª–∞–π–Ω –≤—Ä–µ–º—è!`, 'success');
                saveGameData();
            } else {
                showNotification('–ù–µ—Ç –æ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è', 'warning');
            }
        }

        // ==================== –ï–ñ–ï–î–ù–ï–í–ù–´–ï –ù–ê–ì–†–ê–î–´ –ò –ó–ê–î–ê–ù–ò–Ø ====================
        function claimDailyReward() {
            const today = new Date().toDateString();
            
            if (gameState.lastDaily === today) {
                showNotification('–í—ã —É–∂–µ –ø–æ–ª—É—á–∞–ª–∏ –Ω–∞–≥—Ä–∞–¥—É —Å–µ–≥–æ–¥–Ω—è!', 'error');
                return;
            }
            
            const dayIndex = gameState.dailyStreak % 7;
            const reward = dailyRewards[dayIndex];
            
            gameState.dailyStreak++;
            gameState.lastDaily = today;
            
            switch(reward.type) {
                case 'gold':
                    gameState.gold += reward.value;
                    break;
                case 'silver':
                    gameState.silver += reward.value;
                    break;
                case 'crystal':
                    gameState.crystals += reward.value;
                    break;
                case 'case':
                    gameState.inventory.push(createInventoryItem({
                        name: reward.reward,
                        type: 'case',
                        rarity: reward.value,
                        emoji: reward.emoji,
                        price: 0
                    }, { canSell: true, canCraft: false, source: 'daily' }));
                    break;
                case 'skin':
                    const skins = allItems.filter(item => item.type === 'weapon' && item.rarity === 'rare');
                    const randomSkin = skins[Math.floor(Math.random() * skins.length)];
                    if (randomSkin) {
                        gameState.inventory.push(createInventoryItem(randomSkin, { canSell: true, canCraft: true, source: 'daily' }));
                    }
                    break;
            }
            
            const progress = ((gameState.dailyStreak % 7) / 7) * 100;
            document.getElementById('daily-progress').style.width = `${progress}%`;
            document.getElementById('current-day').textContent = (gameState.dailyStreak % 7) || 7;
            
            showNotification(`–ü–æ–ª—É—á–µ–Ω–∞ –Ω–∞–≥—Ä–∞–¥–∞: ${reward.reward}!`, 'success');
            updateUI();
            renderDailyRewards();
            saveGameData();
        }
        
        function claimQuest(questId) {
            const quests = [
                { id: 1, reward: { type: 'silver', value: 100 } },
                { id: 2, reward: { type: 'gold', value: 50 } },
                { id: 3, reward: { type: 'case', value: 'common' } }
            ];
            
            const quest = quests.find(q => q.id === questId);
            if (!quest) return;
            
            if (questId === 1) {
                gameState.silver += 100;
            } else if (questId === 2) {
                gameState.gold += 50;
            } else if (questId === 3) {
                gameState.inventory.push(createInventoryItem({
                    name: "–û–±—ã—á–Ω—ã–π –∫–µ–π—Å",
                    type: 'case',
                    rarity: 'common',
                    emoji: 'üì¶',
                    price: 0
                }, { canSell: true, canCraft: false, source: 'quest' }));
            }
            
            showNotification(`–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ü–æ–ª—É—á–µ–Ω–æ: ${quest.reward.value} ${quest.reward.type === 'case' ? '–∫–µ–π—Å' : quest.reward.type}`, 'success');
            updateUI();
            renderDailyQuests();
            saveGameData();
        }

        // ==================== –î–û–°–¢–ò–ñ–ï–ù–ò–Ø ====================
        function updateAchievementProgress(achievementId, progress) {
            const achievement = achievementsList.find(a => a.id === achievementId);
            if (!achievement || achievement.completed) return;
            
            achievement.progress += progress;
            if (achievement.progress >= achievement.maxProgress) {
                achievement.progress = achievement.maxProgress;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ gameState
            const savedAchievement = gameState.achievements.find(a => a.id === achievementId);
            if (savedAchievement) {
                savedAchievement.progress = achievement.progress;
                savedAchievement.completed = achievement.completed;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            if (document.getElementById('achievements').classList.contains('active')) {
                renderAchievements();
            }
        }
        
        function claimAchievement(achievementId) {
            const achievement = achievementsList.find(a => a.id === achievementId);
            if (!achievement || achievement.completed) return;
            
            if (achievement.progress >= achievement.maxProgress) {
                achievement.completed = true;
                
                // –í—ã–¥–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É
                switch(achievement.reward.type) {
                    case 'gold':
                        gameState.gold += achievement.reward.value;
                        break;
                    case 'silver':
                        gameState.silver += achievement.reward.value;
                        break;
                    case 'crystal':
                        gameState.crystals += achievement.reward.value;
                        break;
                    case 'skin':
                        // –î–æ–±–∞–≤–ª—è–µ–º —Å–∫–∏–Ω
                        break;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                const savedAchievement = gameState.achievements.find(a => a.id === achievementId);
                if (savedAchievement) {
                    savedAchievement.completed = true;
                }
                
                showNotification(`–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "${achievement.name}" –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ü–æ–ª—É—á–µ–Ω–æ: ${achievement.reward.value} ${getRewardTypeName(achievement.reward.type)}`, 'success');
                updateUI();
                renderAchievements();
                saveGameData();
            }
        }
        
        function updateAchievementStats() {
            const completed = achievementsList.filter(a => a.completed).length;
            const total = achievementsList.length;
            const points = achievementsList.filter(a => a.completed).reduce((sum, a) => sum + a.points, 0);
            const progress = (completed / total) * 100;
            
            document.getElementById('achievement-count').textContent = `${completed}/${total} –∑–∞–≤–µ—Ä—à–µ–Ω–æ`;
            document.getElementById('achievement-points').textContent = points;
            document.getElementById('achievement-progress').style.width = `${progress}%`;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–¥–∫–æ—Å—Ç—å
            let rarity = '–ù–æ–≤–∏—á–æ–∫';
            if (completed >= total * 0.5) rarity = '–û–ø—ã—Ç–Ω—ã–π';
            if (completed >= total * 0.8) rarity = '–í–µ—Ç–µ—Ä–∞–Ω';
            if (completed === total) rarity = '–õ–µ–≥–µ–Ω–¥–∞';
            document.getElementById('achievement-rarity').textContent = rarity;
        }
        
        function updateAchievementsProgress() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
            achievementsList.forEach(ach => {
                if (ach.id === 1) { // –ü–µ—Ä–≤–∞—è –∫—Ä–æ–≤—å
                    ach.progress = gameState.inventory.length > 0 ? 1 : 0;
                } else if (ach.id === 2) { // –ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä
                    ach.progress = gameState.inventory.length;
                } else if (ach.id === 5) { // –ö–ª–∏–∫–µ—Ä-–º–∞—à–∏–Ω–∞
                    ach.progress = gameState.clicks.gold + gameState.clicks.silver;
                } else if (ach.id === 6) { // –ü–æ–±–µ–¥–∏—Ç–µ–ª—å –¥—É—ç–ª–µ–π
                    ach.progress = gameState.duels.wins;
                } else if (ach.id === 7) { // –ë–æ—Ç-—Ñ–µ—Ä–º–µ—Ä
                    ach.progress = gameState.bots.novice + gameState.bots.pro + gameState.bots.mafia;
                } else if (ach.id === 8) { // –°–æ–∑–¥–∞—Ç–µ–ª—å
                    ach.progress = gameState.customSkins.length;
                }
                
                if (ach.progress >= ach.maxProgress) {
                    ach.progress = ach.maxProgress;
                }
            });
        }

        // ==================== PVP –î–£–≠–õ–ò ====================
        function startDuel() {
            if (isDuelStarted || currentDuelBet === 0) return;
            
            if (gameState.silver < currentDuelBet) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–µ—Ä–µ–±—Ä–∞ –¥–ª—è —Å—Ç–∞–≤–∫–∏!', 'error');
                return;
            }
            
            // –°–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç–∞–≤–∫—É
            gameState.silver -= currentDuelBet;
            updateUI();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç
            player1Clicks = 0;
            player2Clicks = 0;
            duelTimeLeft = 10;
            
            document.getElementById('player1-clicks').textContent = '0';
            document.getElementById('player2-clicks').textContent = '0';
            document.getElementById('duel-timer').textContent = duelTimeLeft;
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏
            document.getElementById('player1-btn').disabled = false;
            document.getElementById('player2-btn').disabled = false;
            document.getElementById('start-duel-btn').disabled = true;
            
            isDuelStarted = true;
            duelActive = true;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            duelInterval = setInterval(() => {
                duelTimeLeft--;
                document.getElementById('duel-timer').textContent = duelTimeLeft;
                
                if (duelTimeLeft <= 0) {
                    endDuel();
                }
            }, 1000);
            
            showNotification('–î—É—ç–ª—å –Ω–∞—á–∞–ª–∞—Å—å! –ö–ª–∏–∫–∞–π—Ç–µ –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ!', 'warning');
        }
        
        function duelClick(player) {
            if (!duelActive) return;
            
            if (player === 1) {
                player1Clicks++;
                document.getElementById('player1-clicks').textContent = player1Clicks;
            } else {
                player2Clicks++;
                document.getElementById('player2-clicks').textContent = player2Clicks;
            }
            
            playSound('duel');
            vibrate();
        }
        
        function endDuel() {
            clearInterval(duelInterval);
            duelActive = false;
            isDuelStarted = false;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            const player1Wins = player1Clicks > player2Clicks;
            const isDraw = player1Clicks === player2Clicks;
            
            if (isDraw) {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–≤–∫–∏ –ø—Ä–∏ –Ω–∏—á—å–µ–π
                gameState.silver += currentDuelBet;
                showNotification('–ù–∏—á—å—è! –°—Ç–∞–≤–∫–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã.', 'warning');
            } else if (player1Wins) {
                // –ò–≥—Ä–æ–∫ –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç
                const winnings = currentDuelBet * 2;
                gameState.silver += winnings;
                gameState.duels.wins++;
                
                showNotification(`–ü–æ–±–µ–¥–∞! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${currentDuelBet} —Å–µ—Ä–µ–±—Ä–∞!`, 'success');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
                updateAchievementProgress(6, 1);
            } else {
                // –ò–≥—Ä–æ–∫ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç
                gameState.duels.losses++;
                showNotification('–ü–æ—Ä–∞–∂–µ–Ω–∏–µ! –°—Ç–∞–≤–∫–∞ –ø–æ—Ç–µ—Ä—è–Ω–∞.', 'error');
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é
            gameState.duels.history.push({
                date: Date.now(),
                player1Score: player1Clicks,
                player2Score: player2Clicks,
                bet: currentDuelBet,
                won: player1Wins
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
            document.getElementById('start-duel-btn').disabled = false;
            currentDuelBet = 0;
            document.getElementById('current-bet').textContent = '0';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é
            renderDuels();
            saveGameData();
        }
        
        function setDuelBet(amount) {
            currentDuelBet = amount;
            document.getElementById('current-bet').textContent = amount;
            playSound('click');
        }
        
        function findRandomOpponent() {
            // –í –æ—Ñ–ª–∞–π–Ω –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–æ—Ç–∞
            showNotification('–ü–æ–∏—Å–∫ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...', 'info');
            
            setTimeout(() => {
                // –ë–æ—Ç —Å —Ä–∞–Ω–¥–æ–º–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é –∫–ª–∏–∫–æ–≤
                const botClicksPerSecond = Math.floor(Math.random() * 5) + 3;
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ-–∫–ª–∏–∫–∏ –¥–ª—è –±–æ—Ç–∞
                if (duelActive) {
                    const botInterval = setInterval(() => {
                        if (duelActive) {
                            player2Clicks++;
                            document.getElementById('player2-clicks').textContent = player2Clicks;
                        } else {
                            clearInterval(botInterval);
                        }
                    }, 1000 / botClicksPerSecond);
                }
                
                showNotification('–ù–∞–π–¥–µ–Ω –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫!', 'success');
            }, 1500);
        }

        // ==================== –ö–†–ê–§–¢–ò–ù–ì ====================
        function openCrafting() {
            const container = document.getElementById('crafting-content');
            container.innerHTML = `
                <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è –∫—Ä–∞—Ñ—Ç–∞ (3 –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Ä–µ–¥–∫–æ—Å—Ç–∏)</h3>
                <div style="display: flex; gap: 10px; margin: 20px 0; flex-wrap: wrap;" id="crafting-selection">
                    <!-- –í—ã–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã -->
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-danger" onclick="clearCrafting()">
                        <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                    <button class="btn btn-success" onclick="performCraft()" id="craft-button" disabled>
                        <i class="fas fa-hammer"></i> –°–∫—Ä–∞—Ñ—Ç–∏—Ç—å
                    </button>
                </div>
            `;
            
            renderCraftingItems();
            openModal('crafting-modal');
        }

        function renderCraftingItems() {
            const container = document.getElementById('crafting-items');
            if (!container) return;
            
            container.innerHTML = '';
            
            const craftableItems = gameState.inventory.filter(item => item.canCraft);
            
            craftableItems.forEach(item => {
                const isSelected = selectedItems.includes(item.id);
                const card = document.createElement('div');
                card.className = 'card item-card';
                if (isSelected) {
                    card.style.border = '2px solid var(--secondary)';
                }
                card.innerHTML = `
                    <div class="item-rarity rarity-${item.rarity}">${getRarityName(item.rarity)}</div>
                    <div class="item-image">
                        ${getItemImageHTML(item)}
                    </div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-actions">
                        <button class="item-action" onclick="selectForCraft(${item.id})">
                            <i class="fas fa-${isSelected ? 'times' : 'plus'}"></i>
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function selectForCraft(itemId) {
            const item = gameState.inventory.find(i => i.id === itemId);
            if (!item || !item.canCraft) {
                showNotification('–≠—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫—Ä–∞—Ñ—Ç–µ!', 'error');
                return;
            }
            
            const index = selectedItems.indexOf(itemId);
            if (index > -1) {
                selectedItems.splice(index, 1);
            } else {
                if (selectedItems.length < 3) {
                    selectedItems.push(itemId);
                } else {
                    showNotification('–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ 3 –ø—Ä–µ–¥–º–µ—Ç–∞!', 'error');
                    return;
                }
            }
            
            updateCraftingUI();
            renderCraftingItems();
            playSound('click');
        }

        function updateCraftingUI() {
            const selection = document.getElementById('crafting-selection');
            const craftButton = document.getElementById('craft-button');
            
            if (!selection) return;
            
            selection.innerHTML = '';
            
            selectedItems.forEach(itemId => {
                const item = gameState.inventory.find(i => i.id === itemId);
                if (item) {
                    selection.innerHTML += `
                        <div class="item-card" style="width: 100px;">
                            <div class="item-image">
                                ${getItemImageHTML(item, false, true)}
                            </div>
                            <div class="item-name" style="font-size: 12px;">${item.name}</div>
                        </div>
                    `;
                }
            });
            
            if (craftButton) {
                craftButton.disabled = selectedItems.length !== 3;
            }
        }

        function clearCrafting() {
            selectedItems = [];
            updateCraftingUI();
            renderCraftingItems();
        }

        function performCraft() {
            if (selectedItems.length !== 3) {
                showNotification('–ù—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å 3 –ø—Ä–µ–¥–º–µ—Ç–∞!', 'error');
                return;
            }
            
            const items = selectedItems.map(id => gameState.inventory.find(i => i.id === id));
            
            const firstRarity = items[0].rarity;
            const allSameRarity = items.every(item => item.rarity === firstRarity);
            
            if (!allSameRarity) {
                showNotification('–í—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Ä–µ–¥–∫–æ—Å—Ç–∏!', 'error');
                return;
            }
            
            const rarityOrder = ['common', 'uncommon', 'rare', 'epic', 'legendary'];
            const currentIndex = rarityOrder.indexOf(firstRarity);
            
            if (currentIndex >= rarityOrder.length - 1) {
                showNotification('–ù–µ–ª—å–∑—è —Å–∫—Ä–∞—Ñ—Ç–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç –≤—ã—à–µ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ!', 'error');
                return;
            }
            
            const nextRarity = rarityOrder[currentIndex + 1];
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
            const newItem = {
                id: Date.now(),
                name: `${getRarityName(nextRarity)} ${items[0].type}`,
                type: items[0].type,
                rarity: nextRarity,
                emoji: items[0].emoji,
                price: items[0].price * 3,
                canSell: true,
                canCraft: true,
                hasImage: true,
                stats: { ...items[0].stats, crafted: true }
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            skinImages[newItem.name] = skinImages[items[0].name] || items[0].emoji;
            
            // –£–¥–∞–ª—è–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
            gameState.inventory = gameState.inventory.filter(item => !selectedItems.includes(item.id));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç
            gameState.inventory.push(newItem);
            
            // –û—á–∏—â–∞–µ–º –≤—ã–±–æ—Ä
            selectedItems = [];
            
            showNotification(`–£—Å–ø–µ—à–Ω–æ —Å–∫—Ä–∞—Ñ—á–µ–Ω ${getRarityName(nextRarity)} –ø—Ä–µ–¥–º–µ—Ç!`, 'success');
            closeModal('crafting-modal');
            renderInventory();
            saveGameData();
        }

        // ==================== –ü–†–û–ú–û–ö–û–î–´ ====================
        function usePromoCode() {
            const code = document.getElementById('promo-input').value.trim().toUpperCase();
            const result = document.getElementById('promo-result');
            
            if (!code) {
                result.innerHTML = '<span style="color: var(--danger);">–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥!</span>';
                return;
            }
            
            const promo = gameState.promoCodes[code];
            
            if (!promo) {
                result.innerHTML = '<span style="color: var(--danger);">–ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥!</span>';
                playSound('error');
                return;
            }
            
            if (promo.used) {
                result.innerHTML = '<span style="color: var(--danger);">–ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω!</span>';
                playSound('error');
                return;
            }
            
            switch(promo.type) {
                case 'gold':
                    gameState.gold += promo.value;
                    result.innerHTML = `<span style="color: var(--success);">–ü–æ–ª—É—á–µ–Ω–æ ${promo.value} –≥–æ–ª–¥—ã!</span>`;
                    break;
                case 'silver':
                    gameState.silver += promo.value;
                    result.innerHTML = `<span style="color: var(--success);">–ü–æ–ª—É—á–µ–Ω–æ ${promo.value} —Å–µ—Ä–µ–±—Ä–∞!</span>`;
                    break;
                case 'crystal':
                    gameState.crystals += promo.value;
                    result.innerHTML = `<span style="color: var(--success);">–ü–æ–ª—É—á–µ–Ω–æ ${promo.value} –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤!</span>`;
                    break;
                case 'skin':
                    const skin = allItems.find(item => item.name === promo.value);
                    if (skin) {
                        gameState.inventory.push(createInventoryItem(skin, { canSell: true, canCraft: true, source: 'promo' }));
                        result.innerHTML = `<span style="color: var(--success);">–ü–æ–ª—É—á–µ–Ω —Å–∫–∏–Ω: ${promo.value}!</span>`;
                        renderInventory();
                    }
                    break;
                case 'knife':
                case 'gloves':
                case 'charm':
                case 'sticker':
                    const rewarded = grantItemByType(promo.type, promo.value);
                    result.innerHTML = `<span style="color: var(--success);">–ü–æ–ª—É—á–µ–Ω –ø—Ä–µ–¥–º–µ—Ç: ${rewarded.name}!</span>`;
                    break;
                case 'id':
                    gameState.profile.id = String(promo.value);
                    document.getElementById('player-id').value = promo.value;
                    document.getElementById('profile-id').value = promo.value;
                    result.innerHTML = `<span style="color: var(--success);">ID –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ ${promo.value}!</span>`;
                    break;
            }
            
            gameState.promoCodes[code].used = true;
            updateUI();
            playSound('success');
            saveGameData();
        }

        // ==================== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ====================
        function createPromoCode() {
            const type = document.getElementById('admin-type').value;
            let value = document.getElementById('admin-value').value;
            const code = document.getElementById('admin-code').value.toUpperCase();
            
            if (!type || !value || !code) {
                document.getElementById('admin-message').innerHTML = '<span style="color: var(--danger);">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!</span>';
                return;
            }

            if (['gold', 'silver', 'crystal'].includes(type)) {
                value = parseInt(value, 10);
            }
            
            gameState.promoCodes[code] = { type, value, used: false };
            document.getElementById('admin-message').innerHTML = `<span style="color: var(--success);">–ü—Ä–æ–º–æ–∫–æ–¥ ${code} —Å–æ–∑–¥–∞–Ω!</span>`;
            
            document.getElementById('admin-value').value = '';
            document.getElementById('admin-code').value = '';
            
            playSound('success');
            saveGameData();
        }

        function giveItem() {
            const itemName = document.getElementById('admin-item').value;
            const amount = parseInt(document.getElementById('admin-amount').value) || 1;
            
            if (!itemName) {
                document.getElementById('admin-message').innerHTML = '<span style="color: var(--danger);">–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞!</span>';
                return;
            }
            
            // –ò—â–µ–º –ø—Ä–µ–¥–º–µ—Ç
            let item = allItems.find(i => i.name.toLowerCase().includes(itemName.toLowerCase()));
            
            if (!item) {
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç
                item = {
                    id: Date.now(),
                    name: itemName,
                    type: 'weapon',
                    rarity: 'rare',
                    emoji: 'üéÅ',
                    price: 10000,
                    canSell: true,
                    canCraft: true,
                    hasImage: false,
                    stats: { damage: 30, accuracy: 75, fireRate: 500 }
                };
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            for (let i = 0; i < amount; i++) {
                gameState.inventory.push(createInventoryItem(item, { canSell: true, canCraft: true, source: 'admin' }));
            }
            
            document.getElementById('admin-message').innerHTML = `<span style="color: var(--success);">–î–æ–±–∞–≤–ª–µ–Ω–æ ${amount} –ø—Ä–µ–¥–º–µ—Ç–æ–≤!</span>`;
            document.getElementById('admin-item').value = '';
            
            showNotification(`–ü–æ–ª—É—á–µ–Ω–æ ${amount} –ø—Ä–µ–¥–º–µ—Ç–æ–≤!`, 'success');
            renderInventory();
            saveGameData();
        }

        function banPlayer() {
            const ip = document.getElementById('ban-ip').value.trim();
            const device = document.getElementById('ban-device').value.trim();
            if (!ip && !device) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ IP –∏–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ!', 'error');
                return;
            }
            if (ip) gameState.bans.ips.push(ip);
            if (device) gameState.bans.devices.push(device);
            document.getElementById('ban-ip').value = '';
            document.getElementById('ban-device').value = '';
            renderBanList();
            saveGameData();
            showNotification('–ë–∞–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω (–æ—Ñ–ª–∞–π–Ω –¥–µ–º–æ)', 'warning');
        }

        function renderBanList() {
            const container = document.getElementById('ban-list');
            if (!container) return;
            const ipList = gameState.bans.ips.length ? `IP: ${gameState.bans.ips.join(', ')}` : 'IP: –Ω–µ—Ç';
            const deviceList = gameState.bans.devices.length ? `–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ${gameState.bans.devices.join(', ')}` : '–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: –Ω–µ—Ç';
            container.innerHTML = `<p>${ipList}</p><p>${deviceList}</p>`;
        }

        function openAdminPanel() {
            const hasAccess = localStorage.getItem('standoff_admin') === 'true';
            if (hasAccess) {
                renderBanList();
                openModal('admin-modal');
                return;
            }
            const code = prompt('–í–≤–µ–¥–∏—Ç–µ –∞–¥–º–∏–Ω-–∫–æ–¥:');
            if (code === 'ST2-ADMIN') {
                localStorage.setItem('standoff_admin', 'true');
                renderBanList();
                openModal('admin-modal');
                showNotification('–ê–¥–º–∏–Ω –¥–æ—Å—Ç—É–ø –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω', 'success');
            } else {
                showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω', 'error');
            }
        }

        // ==================== –°–ö–ò–ù–´ (–ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò) ====================
        function previewSkin(file) {
            const preview = document.getElementById('skin-preview');
            
            if (!file) {
                preview.innerHTML = '<p>–ü—Ä–µ–≤—å—é –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</p>';
                return;
            }
            
            if (!file.type.match('image.*')) {
                preview.innerHTML = '<p style="color: var(--danger);">–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ!</p>';
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                preview.innerHTML = `
                    <img src="${e.target.result}" style="max-width: 200px; max-height: 200px; border-radius: 8px;">
                    <p style="margin-top: 10px;">–ü—Ä–µ–≤—å—é —Å–∫–∏–Ω–∞</p>
                `;
            };
            
            reader.readAsDataURL(file);
        }

        function uploadSkin() {
            const nameInput = document.getElementById('skin-name-input');
            const typeSelect = document.getElementById('skin-type-select');
            const raritySelect = document.getElementById('skin-rarity-select');
            const fileInput = document.getElementById('skin-file-input');
            const resultDiv = document.getElementById('upload-skin-result');
            
            const name = nameInput.value.trim();
            const type = typeSelect.value;
            const rarity = raritySelect.value;
            const file = fileInput.files[0];
            
            if (!name) {
                resultDiv.innerHTML = '<span style="color: var(--danger);">–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∫–∏–Ω–∞!</span>';
                return;
            }
            
            if (!file) {
                resultDiv.innerHTML = '<span style="color: var(--danger);">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª —Å–∫–∏–Ω–∞!</span>';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
            if (file.size > 2 * 1024 * 1024) {
                resultDiv.innerHTML = '<span style="color: var(--danger);">–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å. 2MB)!</span>';
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Å–∫–∏–Ω
                const newSkin = {
                    id: Date.now(),
                    name: name,
                    type: type,
                    rarity: rarity,
                    emoji: getEmojiForType(type),
                    price: 1000,
                    canSell: true,
                    canCraft: true,
                    hasImage: true,
                    isCustom: true,
                    stats: { 
                        custom: true,
                        created: new Date().toLocaleDateString(),
                        rarity: rarity 
                    }
                };
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                skinImages[name] = e.target.result;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                allItems.push(newSkin);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–∫–∏–Ω—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                gameState.customSkins.push({
                    name: name,
                    type: type,
                    rarity: rarity,
                    imageData: e.target.result,
                    price: 1000,
                    stats: newSkin.stats
                });
                
                // –°–æ–∑–¥–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
                gameState.inventory.push(createInventoryItem(newSkin, { canSell: true, canCraft: true, source: 'custom' }));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ "–°–æ–∑–¥–∞—Ç–µ–ª—å"
                updateAchievementProgress(8, 1);
                
                resultDiv.innerHTML = `<span style="color: var(--success);">–°–∫–∏–Ω "${name}" —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å!</span>`;
                
                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                nameInput.value = '';
                fileInput.value = '';
                document.getElementById('skin-preview').innerHTML = '<p>–ü—Ä–µ–≤—å—é –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</p>';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º
                saveGameData();
                renderInventory();
                
                setTimeout(() => {
                    closeModal('upload-skin-modal');
                    showNotification(`–°–∫–∏–Ω "${name}" —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!`, 'success');
                }, 1000);
            };
            
            reader.onerror = function() {
                resultDiv.innerHTML = '<span style="color: var(--danger);">–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞!</span>';
            };
            
            reader.readAsDataURL(file);
        }

        function deleteCustomSkin(skinName) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å —Å–∫–∏–Ω "${skinName}"?`)) return;
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ –≤—Å–µ—Ö –º–µ—Å—Ç
            allItems = allItems.filter(item => !(item.name === skinName && item.isCustom));
            gameState.inventory = gameState.inventory.filter(item => !(item.name === skinName && item.isCustom));
            gameState.customSkins = gameState.customSkins.filter(skin => skin.name !== skinName);
            delete skinImages[skinName];
            
            showNotification(`–°–∫–∏–Ω "${skinName}" —É–¥–∞–ª–µ–Ω!`, 'success');
            closeModal('item-modal');
            renderInventory();
            renderSkins();
            saveGameData();
        }

        function copySkinInfo(skinName) {
            const skin = allItems.find(i => i.name === skinName);
            if (!skin) return;
            
            const info = `üéÆ ${skin.name}\nüìä –†–µ–¥–∫–æ—Å—Ç—å: ${getRarityName(skin.rarity)}\nüîß –¢–∏–ø: ${getTypeName(skin.type)}\nüí∞ –¶–µ–Ω–∞: ${skin.price} —Å–µ—Ä–µ–±—Ä–∞`;
            
            navigator.clipboard.writeText(info).then(() => {
                showNotification('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫–∏–Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!', 'success');
            }).catch(() => {
                // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                const textArea = document.createElement('textarea');
                textArea.value = info;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫–∏–Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!', 'success');
            });
        }
        
        // ==================== 3D –ò AR –ü–†–û–°–ú–û–¢–† ====================
        function preview3D(skinName) {
            const skin = allItems.find(i => i.name === skinName);
            if (!skin) return;
            
            const preview = document.getElementById('3d-preview');
            const controls = document.getElementById('3d-controls');
            
            preview.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 96px; margin-bottom: 20px; transform: rotateY(20deg); transition: transform 0.3s;" id="3d-model">
                        ${skin.emoji}
                    </div>
                    <h3>${skin.name}</h3>
                    <p>${getRarityName(skin.rarity)} ${getTypeName(skin.type)}</p>
                </div>
            `;
            
            controls.style.display = 'flex';
            showNotification('3D –ø—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω', 'info');
        }
        
        function rotateSkin(direction) {
            const model = document.getElementById('3d-model');
            if (!model) return;
            
            const currentRotation = model.style.transform.match(/rotateY\(([-0-9.]+)deg\)/);
            let angle = currentRotation ? parseFloat(currentRotation[1]) : 20;
            
            if (direction === 'left') {
                angle -= 45;
            } else {
                angle += 45;
            }
            
            model.style.transform = `rotateY(${angle}deg)`;
        }
        
        function toggleSkinAnimation() {
            const model = document.getElementById('3d-model');
            if (!model) return;
            
            if (model.style.animation) {
                model.style.animation = '';
            } else {
                model.style.animation = 'spin 3s linear infinite';
            }
        }
        
        function resetSkinView() {
            const model = document.getElementById('3d-model');
            if (model) {
                model.style.transform = 'rotateY(20deg)';
                model.style.animation = '';
            }
        }
        
        function startARMode() {
            if (!('WebXR' in window)) {
                showNotification('AR –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ', 'error');
                return;
            }
            
            document.getElementById('ar-container').style.display = 'block';
            showNotification('AR —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω', 'success');
        }
        
        function startARSkin(skinName) {
            startARMode();
            showNotification(`AR –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–∫–∏–Ω–∞: ${skinName}`, 'info');
        }
        
        function rotateARSkin(direction) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã 3D –º–æ–¥–µ–ª—å
            showNotification(`–ü–æ–≤–æ—Ä–æ—Ç ${direction === 'left' ? '–≤–ª–µ–≤–æ' : '–≤–ø—Ä–∞–≤–æ'}`, 'info');
        }
        
        function takeARScreenshot() {
            showNotification('–°–∫—Ä–∏–Ω—à–æ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
        }
        
        function exitARMode() {
            document.getElementById('ar-container').style.display = 'none';
        }

        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å–∫–∏–Ω–æ–≤
        function getItemImageHTML(item, large = false, small = false) {
            if (!item) return '<div class="emoji-fallback">‚ùì</div>';
            
            const hasImage = item.hasImage && skinImages[item.name];
            const imageUrl = skinImages[item.name];
            
            if (hasImage && imageUrl && typeof imageUrl === 'string') {
                const size = large ? '200px' : small ? '32px' : '120px';
                const imgStyle = `max-height: ${size}; width: auto;`;
                
                return `
                    <img src="${imageUrl}" 
                         class="item-img" 
                         style="${imgStyle}" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                         onload="this.style.display='block'; this.nextElementSibling.style.display='none';">
                    <div class="emoji-fallback" style="font-size: ${large ? '64px' : small ? '32px' : '48px'}; display: none;">
                        ${item.emoji}
                    </div>
                `;
            } else {
                const size = large ? '64px' : small ? '32px' : '48px';
                return `<div class="emoji-fallback" style="font-size: ${size};">${item.emoji}</div>`;
            }
        }

        function getEmojiForType(type) {
            const emojis = {
                'weapon': 'üî´',
                'knife': 'üî™',
                'gloves': 'üß§',
                'charm': 'üíñ',
                'sticker': 'üêâ',
                'case': 'üì¶'
            };
            return emojis[type] || 'üéÅ';
        }

        function getTypeName(type) {
            const names = {
                'weapon': '–û—Ä—É–∂–∏–µ',
                'knife': '–ù–æ–∂',
                'gloves': '–ü–µ—Ä—á–∞—Ç–∫–∏',
                'charm': '–ë—Ä–µ–ª–æ–∫',
                'sticker': '–ù–∞–∫–ª–µ–π–∫–∞',
                'case': '–ö–µ–π—Å',
                'title': '–¢–∏—Ç—É–ª'
            };
            return names[type] || type;
        }
        
        function getStatName(stat) {
            const names = {
                'damage': '–£—Ä–æ–Ω',
                'accuracy': '–¢–æ—á–Ω–æ—Å—Ç—å',
                'fireRate': '–°–∫–æ—Ä–æ—Å—Ç—Ä–µ–ª—å–Ω–æ—Å—Ç—å',
                'speed': '–°–∫–æ—Ä–æ—Å—Ç—å',
                'armor': '–ë—Ä–æ–Ω—è',
                'grip': '–•–≤–∞—Ç',
                'luck': '–£–¥–∞—á–∞',
                'style': '–°—Ç–∏–ª—å',
                'special': '–û—Å–æ–±–æ–µ',
                'custom': '–ö–∞—Å—Ç–æ–º–Ω—ã–π',
                'created': '–°–æ–∑–¥–∞–Ω',
                'rarity': '–†–µ–¥–∫–æ—Å—Ç—å',
                'crafted': '–°–∫—Ä–∞—Ñ—á–µ–Ω'
            };
            return names[stat] || stat;
        }
        
        function getRewardTypeName(type) {
            const names = {
                'gold': '–≥–æ–ª–¥—ã',
                'silver': '—Å–µ—Ä–µ–±—Ä–∞',
                'crystal': '–∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤',
                'skin': '—Å–∫–∏–Ω',
                'case': '–∫–µ–π—Å'
            };
            return names[type] || type;
        }

        function updateUI() {
            document.getElementById('gold-amount').textContent = gameState.gold;
            document.getElementById('silver-amount').textContent = gameState.silver;
            document.getElementById('crystal-amount').textContent = gameState.crystals;
            
            if (document.getElementById('gold-clicks')) {
                document.getElementById('gold-clicks').textContent = gameState.clicks.gold;
                document.getElementById('silver-clicks').textContent = gameState.clicks.silver;
                document.getElementById('total-gold').textContent = gameState.earned.gold;
                document.getElementById('total-silver').textContent = gameState.earned.silver;
            }

            const profileLevel = document.getElementById('profile-level');
            if (profileLevel) {
                profileLevel.textContent = gameState.level;
            }
            
            updateBotsDisplay();
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notification-text');
            
            notification.className = `notification ${type}`;
            text.innerHTML = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
            
            playSound(type === 'error' ? 'error' : 'success');
        }

        function playSound(soundName) {
            if (!gameState.settings.sound) return;
            
            const sound = document.getElementById(`${soundName}-sound`);
            if (sound) {
                sound.currentTime = 0;
                sound.play().catch(e => console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞"));
            }
        }

        function vibrate() {
            if (gameState.settings.vibration && 'vibrate' in navigator) {
                navigator.vibrate(50);
            }
        }

        function getRarityName(rarity) {
            const names = {
                'common': '–û–±—ã—á–Ω—ã–π',
                'uncommon': '–ù–µ–æ–±—ã—á–Ω—ã–π',
                'rare': '–†–µ–¥–∫–∏–π',
                'epic': '–≠–ø–∏—á–µ—Å–∫–∏–π',
                'legendary': '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π'
            };
            return names[rarity] || rarity;
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            playSound('click');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            if (modalId === 'case-modal') {
                caseOpeningInProgress = false;
            }
            playSound('click');
        }

        function showAd(type) {
            showNotification('–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∫–ª–∞–º—ã...', 'info');
            
            setTimeout(() => {
                if (type === 'gold') {
                    gameState.gold += 100;
                    showNotification('+100 –≥–æ–ª–¥—ã –∑–∞ —Ä–µ–∫–ª–∞–º—É!', 'success');
                } else if (type === 'silver') {
                    gameState.silver += 500;
                    showNotification('+500 —Å–µ—Ä–µ–±—Ä–∞ –∑–∞ —Ä–µ–∫–ª–∞–º—É!', 'success');
                } else if (type === 'crystal') {
                    gameState.crystals += 5;
                    showNotification('+5 –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ –∑–∞ —Ä–µ–∫–ª–∞–º—É!', 'success');
                }
                updateUI();
                saveGameData();
            }, 1500);
        }

        function toggleRotate() {
            document.body.classList.toggle('rotated');
            playSound('click');
        }

        function toggleMusic() {
            const music = document.getElementById('music');
            const btn = document.getElementById('music-btn');
            
            if (music.paused) {
                music.play();
                btn.innerHTML = '<i class="fas fa-music"></i>';
                gameState.settings.music = true;
                showNotification('–ú—É–∑—ã–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞', 'success');
            } else {
                music.pause();
                btn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                gameState.settings.music = false;
                showNotification('–ú—É–∑—ã–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞', 'warning');
            }
            const musicToggle = document.getElementById('music-toggle');
            if (musicToggle) musicToggle.checked = gameState.settings.music;
            saveGameData();
        }

        function toggleSound() {
            const btn = document.getElementById('sound-btn');
            gameState.settings.sound = !gameState.settings.sound;
            
            if (gameState.settings.sound) {
                btn.innerHTML = '<i class="fas fa-volume-up"></i>';
                showNotification('–ó–≤—É–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã', 'success');
            } else {
                btn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                showNotification('–ó–≤—É–∫–∏ –≤—ã–∫–ª—é—á–µ–Ω—ã', 'warning');
            }
            const soundToggle = document.getElementById('sound-toggle');
            if (soundToggle) soundToggle.checked = gameState.settings.sound;
            
            saveGameData();
        }

        function syncAudioButtons() {
            const soundBtn = document.getElementById('sound-btn');
            if (soundBtn) {
                soundBtn.innerHTML = gameState.settings.sound ? '<i class="fas fa-volume-up"></i>' : '<i class="fas fa-volume-mute"></i>';
            }
            const music = document.getElementById('music');
            const musicBtn = document.getElementById('music-btn');
            if (gameState.settings.music) {
                music.play().catch(() => {});
                if (musicBtn) musicBtn.innerHTML = '<i class="fas fa-music"></i>';
            } else {
                music.pause();
                if (musicBtn) musicBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
            }
            const musicToggle = document.getElementById('music-toggle');
            const soundToggle = document.getElementById('sound-toggle');
            if (musicToggle) musicToggle.checked = gameState.settings.music;
            if (soundToggle) soundToggle.checked = gameState.settings.sound;
        }

        function createBackgroundAnimation() {
            const container = document.getElementById('bgAnimation');
            
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = Math.random() * 3 + 1 + 'px';
                particle.style.height = particle.style.width;
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animation = `float ${Math.random() * 10 + 10}s linear infinite`;
                container.appendChild(particle);
            }
        }

        // ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================
        function saveSettings() {
            gameState.settings.music = document.getElementById('music-toggle').checked;
            gameState.settings.sound = document.getElementById('sound-toggle').checked;
            gameState.settings.vibration = document.getElementById('vibration-toggle').checked;
            gameState.settings.notifications = document.getElementById('notifications-toggle').checked;
            gameState.playerTitle = document.getElementById('player-title').value;
            gameState.profile.name = document.getElementById('player-name').value || gameState.profile.name;
            gameState.profile.id = document.getElementById('player-id').value || gameState.profile.id;
            
            const music = document.getElementById('music');
            if (gameState.settings.music) {
                music.play();
            } else {
                music.pause();
            }
            
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
            saveGameData();
        }

        function requestPushNotifications() {
            if (!('Notification' in window)) {
                showNotification('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ', 'warning');
                return;
            }
            if (!gameState.settings.notifications) {
                showNotification('–í–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö', 'warning');
                return;
            }
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    new Notification('Standoff 2', { body: '–ü—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã!' });
                    showNotification('–ü—É—à-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω—ã!', 'success');
                } else {
                    showNotification('–î–æ—Å—Ç—É–ø –∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º –æ—Ç–∫–ª–æ–Ω—ë–Ω', 'error');
                }
            });
        }

        function changeName() {
            const name = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –Ω–∏–∫–Ω–µ–π–º:', '–ò–≥—Ä–æ–∫');
            if (name) {
                document.getElementById('player-name').value = name;
                gameState.profile.name = name;
                showNotification('–ù–∏–∫–Ω–µ–π–º –∏–∑–º–µ–Ω–µ–Ω!', 'success');
                saveGameData();
            }
        }

        function changeNameFromProfile() {
            const name = document.getElementById('profile-name').value.trim();
            if (name) {
                gameState.profile.name = name;
                document.getElementById('player-name').value = name;
                showNotification('–ù–∏–∫–Ω–µ–π–º –∏–∑–º–µ–Ω–µ–Ω!', 'success');
                renderProfile();
                saveGameData();
            }
        }

        function changeIdWithAd() {
            showNotification('–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∫–ª–∞–º—ã...', 'info');
            
            setTimeout(() => {
                const newId = Math.floor(100000 + Math.random() * 900000);
                document.getElementById('player-id').value = newId;
                document.getElementById('profile-id').value = newId;
                gameState.profile.id = String(newId);
                renderProfile();
                showNotification('ID –∏–∑–º–µ–Ω–µ–Ω!', 'success');
                saveGameData();
            }, 1500);
        }

        function selectAvatar(avatarId) {
            gameState.profile.avatar = avatarId;
            gameState.profile.customAvatar = null;
            renderProfile();
            saveGameData();
            showNotification('–ê–≤–∞—Ç–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω!', 'success');
        }

        function handleAvatarUpload(file) {
            if (!file) return;
            if (!file.type.match('image.*')) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞!', 'error');
                return;
            }
            const reader = new FileReader();
            reader.onload = function(e) {
                gameState.profile.customAvatar = e.target.result;
                renderProfile();
                saveGameData();
                showNotification('–ê–≤–∞—Ç–∞—Ä –∑–∞–≥—Ä—É–∂–µ–Ω!', 'success');
            };
            reader.readAsDataURL(file);
        }

        function applyCustomization(type) {
            showNotification(`–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: ${getTypeName(type)}`, 'success');
        }

        function exportSave() {
            const data = JSON.stringify(gameState, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'standoff2_save.json';
            a.click();
            
            URL.revokeObjectURL(url);
            showNotification('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ!', 'success');
        }

        function resetProgress() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω!')) {
                localStorage.removeItem('standoff2_save');
                location.reload();
            }
        }
        
        function showInstallInstructions() {
            const instructions = `
                <h3>–ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Standoff 2 –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h3>
                <p><strong>Android (Chrome):</strong></p>
                <ol>
                    <li>–û—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é (—Ç—Ä–∏ —Ç–æ—á–∫–∏ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É)</li>
                    <li>–í—ã–±–µ—Ä–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"</li>
                    <li>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É</li>
                </ol>
                
                <p><strong>iOS (Safari):</strong></p>
                <ol>
                    <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"</li>
                    <li>–ü—Ä–æ–ª–∏—Å—Ç–∞–π—Ç–µ –≤–Ω–∏–∑ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–ù–∞ —ç–∫—Ä–∞–Ω ¬´–î–æ–º–æ–π¬ª"</li>
                    <li>–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</li>
                </ol>
                
                <p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ PWA:</strong></p>
                <ul>
                    <li>–†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω</li>
                    <li>–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞</li>
                    <li>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</li>
                    <li>–ó–Ω–∞—á–æ–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ</li>
                </ul>
            `;
            
            showNotification(instructions, 'info');
        }

        // ==================== –°–û–•–†–ê–ù–ï–ù–ò–ï ====================
        function saveGameData() {
            const data = {
                ...gameState,
                lastSave: Date.now(),
                lastPlayTime: Date.now()
            };
            localStorage.setItem('standoff2_save', JSON.stringify(data));
        }

        function loadGameData() {
            const saved = localStorage.getItem('standoff2_save');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    Object.assign(gameState, data);

                    gameState.stats = gameState.stats || { itemsSold: 0, casesOpened: 0 };
                    gameState.profile = gameState.profile || { name: "–ò–≥—Ä–æ–∫", id: "123456", avatar: "default-1", customAvatar: null };
                    gameState.battlePass = gameState.battlePass || { level: 1, exp: 0, expToNext: 100, premium: false, claimed: [], questsClaimed: [] };
                    gameState.trades = gameState.trades || [];
                    gameState.bans = gameState.bans || { ips: [], devices: [] };
                    gameState.inventory = (gameState.inventory || []).map(item => ({
                        ...item,
                        canSell: item.canSell !== undefined ? item.canSell : true,
                        canCraft: item.canCraft !== undefined ? item.canCraft : true
                    }));
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–∫–∏–Ω—ã
                    if (gameState.customSkins && gameState.customSkins.length > 0) {
                        gameState.customSkins.forEach(skin => {
                            skinImages[skin.name] = skin.imageData;
                        });
                    }
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    document.getElementById('music-toggle').checked = gameState.settings.music;
                    document.getElementById('sound-toggle').checked = gameState.settings.sound;
                    document.getElementById('vibration-toggle').checked = gameState.settings.vibration;
                    document.getElementById('notifications-toggle').checked = gameState.settings.notifications;
                    document.getElementById('player-title').value = gameState.playerTitle || '–Ω–æ–≤–∏—á–æ–∫';
                    document.getElementById('player-name').value = (gameState.profile && gameState.profile.name) ? gameState.profile.name : '–ò–≥—Ä–æ–∫';
                    document.getElementById('player-id').value = (gameState.profile && gameState.profile.id) ? gameState.profile.id : '123456';
                    syncAudioButtons();
                    renderProfile();
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥
                    updateOfflineEarnings();
                    
                    showNotification('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!', 'success');
                } catch (e) {
                    console.log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
                }
            }
        }
    </script>
</body>
</html>